<apex:page controller="BMCServiceDesk.RequestDefController" showHeader="false"
    sidebar="false" id="thePage" contentType="{!contetnTypeForIE}"
    standardStylesheets="true">
    <c:CommonIncludes />
    <script type="text/javascript"
        src="{!$Resource.SDEFExtJS}/ex/ux/CheckColumn.js"></script>
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/itemselector.js"/>
    <script type="text/javascript" src="{!$Resource.SDEFCommonJS}/Vtabpanel.js"></script>
    <link rel="Stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/Knowledge.css" />
    
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/JSCommon.js"
        id="JSCommon-js" />
    <link rel="stylesheet" type="text/css"
        href="{!$Resource.SDEFExtJS}/ex/ux/css/Spinner.css" />
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFExtJS}/ex/ux/Spinner.js" />
    <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFExtJS}/ex/ux/SpinnerField.js" />
    <script type="text/javascript" src="{!$Resource.SDEFCommonJS}/HTML_ENCODE_DECODE.js"></script>
	<script type="text/javascript"
        src="{!$Resource.SDEFCommonJS}/ReqDefPage.js"></script>
	<style>
	.x-grid3-hd-16
		{
		color:#2E7DB3;
		}
	.TextboxPopupIcon{
		margin-right: 8px;
		}
	</style>
    <script>
       var entitlementOptionSelected;
       var isInputDetailDirty = false;
       var isforIncidentTemplateLookup =false;     
       Ext.ns("RequestDefPage");
            RequestDefPage.Labels = {
            PM_PageLoad: '{!JSENCODE($Label.PM_PageLoad)}',
            PM_netwokLatency: '{!JSENCODE($Label.PM_netwokLatency)}'
            }
            
             var stime = '{!serverstarttime}';
             var etime = '{!serverendtime}';
             var data = '';
             data += '{!JSENCODE($Label.PM_servertime)}';
             if(etime - stime == 0){
                data += 0;
             }
           var labelSavedSuccessfully = '{!JSENCODE($Label.SavedSuccessfully)}',            
        	labelClone = '{!JSENCODE($Label.Clone)}',
            labelDelete = '{!JSENCODE($Label.Delete)}',
            labelSrch = '{!JSENCODE($Label.search)}',
            labelNoRecord = '{!JSENCODE($Label.MsgNoRecordFoundSearchPage)}',
            labelQuestion = '{!JSENCODE($Label.Question)}',
            labelWarning = '{!JSENCODE($Label.Warning)}',
            labelError = '{!JSENCODE($Label.Error)}',
            labelInfo = '{!JSENCODE($Label.Information)}',
            labelMinChar = '{!JSENCODE($Label.GsErrorMsg)}',
            labelNew = '{!JSENCODE($Label.New)}',
            labelSave = '{!JSENCODE($Label.Save)}',
            labelOK = '{!JSENCODE($Label.OK)}',
            labelCancel = '{!JSENCODE($Label.Cancel)}',
            labelCopy = '{!JSENCODE($Label.Copy)}',
            labelReset = '{!JSENCODE($Label.Reset)}', 
            labelRefresh = '{!JSENCODE($Label.Refresh)}',           
            labelPreviousRecord = '{!JSENCODE($Label.PreviousRecord)}',
            labelInactive ='{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.inactive__c.label)}',
            labelNextRecord = '{!JSENCODE($Label.NextRecord)}',
			labelPrevious = '{!JSENCODE($Label.PreviousPage)}',
			labelNext = '{!JSENCODE($Label.NextPage)}',
			labelUp='{!JSENCODE($Label.IconUp)}',
			labelDown='{!JSENCODE($Label.IconDown)}',
            AvailableAccounts = '{!JSENCODE($Label.AvailableAccounts)}',
            SelectedAccounts = '{!JSENCODE($Label.SelectedAccounts)}',
            SelectedProfile = '{!JSENCODE($Label.SelectedProfile)}',
            AvailableProfile = '{!JSENCODE($Label.AvailableProfile)}',
            AvailablePermissionSets = '{!JSENCODE($Label.AvailablePermissionsetsSRD)}',
            SelectedPermissionSets =  '{!JSENCODE($Label.SelectedPermissionsetsSRD)}',
            targetInDays = '{!reqDefBean.targetInDays}',
            targetInHours = '{!reqDefBean.targetInHours}',
            LabelOptions = '{!JSENCODE($Label.Options)}',
            labelDeleteConfirm = '{!JSENCODE($Label.DeleteConfirmMessage)}',
            invalidurl = '{!JSENCODE($Label.invalidURL)}',
        	errorboxtitle= '{!JSENCODE($Label.Error)}',
            reqDefWindowHeader = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.label)}',
            fulfillmentInputWindowHeader = '{!JSENCODE($Label.fulfillmentInput)}',
            taskTemplateExecutionOrder = '{!JSENCODE($Label.taskTemplateExecutionOrder)}',
            close = '{!JSENCODE($Label.Close)}',
            TextAreaOverflow = '{!JSENCODE($Label.TextAreaOverflow)}',
			CreateNewRequestDetailTemplate = '{!JSENCODE($Label.Create_New_Request_Defination_Template)}',
			labelInputTabTitle = '{!JSENCODE($Label.InputNameLabel)}',
			labelNewTemplate = '{!JSENCODE($Label.New)}'+' '+'{!JSENCODE($Label.Template)}',
			labelExistingTemplate = '{!JSENCODE($Label.ExistingTemplate)}',
			labelRequired = '{!JSENCODE($Label.Required)}',
			labelType = '{!JSENCODE($Label.Type)}',
			labelWarningTitle = '{!JSENCODE($Label.Warning)}',
			labelUnsavedFulfillmentInputWarning = '{!JSENCODE($Label.UnsavedFulfillmentInput_Warning)}',
			labelFulfillmentCriteria = '{!JSENCODE($Label.Fulfillment_Criteria_CI_Asset)}',
			newTitle;
            var createNewTemplateLabel= '{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.Template)}';
            var Description = '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.description__c.label)}';
            var infixCondition ='';
            var postfixCondition =''
            var isFlattenedCmdb = {!isFlattenedCmdb}; 
            var AddImage= '{!JSENCODE($Label.AddImage)}';
        
            var isRequestDefCreatable = '{!reqDefBean.isRequestDefCreatable}';
            var isrequestDefUpdateble = '{!reqDefBean.isrequestDefUpdateble}';
            var isRequestDefDeletable = '{!reqDefBean.isRequestDefDeletable}';  
			
			var ALL = '{!reqDefBean.ALL}';
            var PROFILE_PREFIX = '{!reqDefBean.PROFILE_PREFIX}';
            var PERMISSIONSET_PREFIX = '{!reqDefBean.PERMISSIONSET_PREFIX}';

            var dateValue = '{!JSENCODE(reqDefBean.filterClauseDate)}';
            var dateClause = escape('(serviceType__c != \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ')');
            if(!isFlattenedCmdb){
            	dateClause = escape('(serviceType__c != \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
            }else{
            	dateClause = escape('(serviceType__c != \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
            }
            
            var isInActive = {!reqDefBean.isInActive};

            function getPreFirstBtn(){
                return !{!IF(paginator.hasPrevious,'true','false')};
            }
            function getNextLastBtn(){
                return !{!IF(paginator.hasNext,'true','false')};
            }
            function getIsDirect(){
                return '{!JSENCODE($CurrentPage.parameters.isDirect)}';
            }
            function getReqDefID(){
                return '{!reqDefBean.reqDefObj.Id}';
            }
            function getWID(){
                return '{!JSENCODE($CurrentPage.parameters.wid)}';
            }           
            function getImageID(attachmentId){
             document.getElementById('{!$Component.ReqDefForm.Image_Id}').src='/servlet/servlet.FileDownload?file='+attachmentId;
                 setReqDefDoc(attachmentId);
            }
            function getSDFStylesResPath(){
            var resPath = '{!$Resource.SDEFStyles}';
            return resPath;  
            }
            function getDaysTargetHiddenEle(){            
            return document.getElementById('{!$Component.ReqDefForm.targetInDays}');
            }
            
            function enableRequiredAttachment(){
            var attachmentChecked = document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachment}').checked;
            if(attachmentChecked)
           		 document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').disabled = false;
            else{
	             document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').disabled = true;
	             document.getElementById('{!$Component.thePage.ReqDefForm.reqDefAttachmentRequired}').checked = false;
            	}
            }
            function getHoursTargetHiddenEle(){            
            return document.getElementById('{!$Component.ReqDefForm.targetInHours}');
            }
            function getRefDefDescriptionEle(){
            return document.getElementById('{!$Component.ReqDefForm.ReqDef_Description}');
            }
            function setCatData(id, name, catUrgency) {
            document.getElementById('{!$Component.ReqDefForm.Category__c_id_name}').value = name;
            document.getElementById('{!$Component.ReqDefForm.Category__c_id_id}').value = id;
            document.getElementById('{!$Component.ReqDefForm.Category__c_id_fkurgency__c}').value = catUrgency;
            }
            function openImagePopup(){
                var folder = '{!folderId}';
                if(document.getElementById('radioCom').checked == true){
                    openPopupWithTitle('DocPage?folderId='+ folder ,'',AddImage,180,470,false);
                }else if(document.getElementById('radioSF').checked = true){
                    var percetage = encodeURIComponent('%');
                    var clause = encodeURIComponent('ContentType like \'image'+percetage+'\' AND FolderId = \''+ folder+'\'');
                    if(!inProgress){
                        openPopupRF('SearchPage?popupId=Document&isLookup=true&filterClause=' + clause ,setReqDefDoc);
                    }
                }
            }
            function updateTitle(){
                if(errormsg == '{!JSENCODE($Label.SavedSuccessfully)}'){
                    var wid = getWID();
                    window.parent.changeTitle(wid,newTitle,newTitle);
                    window.parent.refreshList();
                }
            }
            function assignApexErrorMessage(){
            
                var elem = document.getElementById('apexMessageErrorPanelDiv');
                if(elem != null && elem.firstChild != null){
                    var ulList = elem.firstChild;
                    var msgvalue = ulList.firstChild.innerText || ulList.firstChild.textContent;
                    Ext.MessageBox.show({ msg: msgvalue, buttons: Ext.MessageBox.OK});
                }
            }
            
            function resetEntitlementData(){
                
                accLeftStore.removeAll();
                accRightStore.removeAll();
                
                accLeftStore.loadData(accLeftStoreData);
                accRightStore.loadData(accRightStoreData);


                leftStore.removeAll();
                rightStore.removeAll();
				
                if (entitlementOptionSelected == PERMISSIONSET_PREFIX) {
                    leftStore.loadData(permissionsetLeftStoreData);
                	rightStore.loadData(permissionsetRightStoreData);
                } else {
                	leftStore.loadData(profileLeftStoreData);
                	rightStore.loadData(profileRightStoreData);
         		}
        }
        
        //Data for request fulfillment
        //Process labels
         var labelProcessNameHeader = '{!JSENCODE($Label.FulfillmentProcessName)}',
             labelProcessDescHeader = '{!JSENCODE($ObjectType.SYSTemplate__c.fields.description__c.label)}',
             labelAdd='{!JSENCODE($Label.Add)}',
             labelProcessTab = '{!JSENCODE($Label.Template)}';
             
         
         //Input labels
         var labelInputPromptHeader = '{!JSENCODE($Label.PromptQuestionHeader)}',
             labelResponseTypeHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.ResponseType__c.label)}', 
             labelRequiredHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.Required__c.label)}',
             labelHiddenHeader = '{!JSENCODE($ObjectType.SRM_FulfillmentInputs__c.fields.Hidden__c.label)}',
             labelColumnHeader = '{!JSENCODE($Label.Column)}',
             labelEdit = '{!JSENCODE($Label.CMDBEdit)}',
             labelInputDeleteConfirmMsg = '{!JSENCODE($Label.InputDeleteConfirmMessage)}',
             labelProcessDeleteConfirmMsg = '{!JSENCODE($Label.ProcessDeleteConfirmMessage)}',
             labelInputTab = '{!JSENCODE($Label.InputNameLabel)}';
			 labelHideRDInputList = '{!JSENCODE($Label.Supporting_Hide)}'+' '+'{!JSENCODE($Label.the_Request_Input_List)}';
             labelShowRDInputList =  '{!JSENCODE($Label.Show)}'+' '+'{!JSENCODE($Label.the_Request_Input_List)}';
         
         //Mapping labels
         var labelRequestInputCaption = '{!JSENCODE($Label.RequestInputSource)}',
             labelProcessVariableCaption = '{!JSENCODE($Label.ProcessVariableTarget)}',
             labelRequestInputHeader = '{!JSENCODE($Label.RequestInputPromptQuestionHeader)}',
             labelProcessVariableHeader = '{!JSENCODE($Label.CIExpField)}',
             labelConcatenateSelection = '{!JSENCODE($Label.ConcatenateInputSelections)}',
             labelMappingTab = '{!JSENCODE($Label.MappingTabTitle)}';
        
        
        //Error message labels
        var labelNone='{!JSENCODE($Label.None)}',
            labelSelectInputError='{!JSENCODE($Label.PleaseSelectRequestInput)}',
            labelSelectProcessVarError='{!JSENCODE($Label.PleaseSelectProcessVariable)}';
        var labelNewBusinessService ='{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.BusinessService)}';
		var labelNewServiceOffering ='{!JSENCODE($Label.Create_New)}'+' '+'{!JSENCODE($Label.ServiceOffering)}';
        
         var  reDefId = '{!reqDefBean.reqDefObj.id}';
		 var LKfilterId = '{!reqDefBean.reqDefObj.FKLookupFilter__c}';
         var wid2 = '{!JSENCODE($CurrentPage.parameters.wid)}';
         var processFilterClause = escape('(templateFor__c=\'Change Request\' or templateFor__c=\'Task\')');
         
         var isInputOrderChanged = false;
         var reqInputOrderCompId = '{!$Component.ReqDefForm.reqInputOrder}';
         var linkProcessTemplate="/apex/SearchPage?popupId=ProcessTemplate&view=list&pgheight=656";
         function getSDFStylesResPath(){
             var resPath = '{!$Resource.SDEFStyles}';
             return resPath;
         }
          
        /*
        Check user premissions           
        */
        var isProcessCreateable = '{!reqDefBean.isProcessCreateable}';
        var isProcessDeleteable = '{!reqDefBean.isProcessDeleteable}';
        var isInputCreateable = '{!reqDefBean.isInputCreateable}';
        var isInputUpdateable = '{!reqDefBean.isInputUpdateable}';
        var isInputDeleteable = '{!reqDefBean.isInputDeleteable}';
        var isMappingCreateable = '{!reqDefBean.isMappingCreateable}';
        var isMappingDeleteable = '{!reqDefBean.isMappingDeleteable}';
        var dispTypeTxt = '{!reqDefBean.dispTypeTxt}', dispTypeTxtArea='{!reqDefBean.dispTypeTxtArea}', dispTypeBoolean='{!reqDefBean.dispTypeBoolean}',
            dispTypeInt='{!reqDefBean.dispTypeInt}', dispTypeDouble='{!reqDefBean.dispTypeDouble}', dispTypeCurr='{!reqDefBean.dispTypeCurr}', 
            dispTypeDate='{!reqDefBean.dispTypeDate}',dispTypeDateTime='{!reqDefBean.dispTypeDateTime}', dispTypePicklist='{!reqDefBean.dispTypePicklist}', dispTypeMultiPicklist='{!reqDefBean.dispTypeMultiPicklist}',
            dispTypeReference='{!reqDefBean.dispTypeReference}', refTypeImpact='{!reqDefBean.refTypeImpact}', refTypeCategory='{!reqDefBean.refTypeCategory}', refTypeUrgency='{!reqDefBean.refTypeUrgency}';
 
        
        function setBusiOffering(){
            var fkBusinessOffering;
            if(!isFlattenedCmdb){
            	fkBusinessOffering = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1}').value;
            }else{
            	fkBusinessOffering = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id__x_1}').value;
            }
            if(fkBusinessOffering != null && fkBusinessOffering != ''){
                setServiceOffering(fkBusinessOffering);
            }
        }
        function setofferingClausePanelData()
        {
            isReqDefDeleted = {!isReqDefDeleted};
            errormsg = '{!JSENCODE(reqDefBean.messageString)}'; 
            OfferingClause = null;
            //var fkService = '{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
            var fkService ='';
            var bsEle;
            if(!isFlattenedCmdb){
            	bsEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c}');
            	if(bsEle!=null){
					fkService = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_fkbmc_baseelement__c}').value;
				} 
            }else{
            	bsEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}');
            	if(bsEle!=null){
					fkService = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}').value;
				}
            } 
			
            var fkServiceField = '';
            var offeringEle;
             if(!isFlattenedCmdb){
             	offeringEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}');
             }else{
             	offeringEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
             } 
			
			if(offeringEle!=null){
					fkServiceField = offeringEle.value; 
			}
			
			if(!isFlattenedCmdb){
	            if(fkService != null && fkService != '' && fkServiceField != null && fkServiceField != ''){
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
	            }else{
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
	            }
            }else{
            	if(fkService != null && fkService != '' && fkServiceField != null && fkServiceField != ''){
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
	            }else{
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
	            }
				onServiceChange();
            }
        }
        
     </script>
    <link rel="stylesheet" type="text/css"
        href="{!$Resource.SDEFStyles}/CustomViews.css" />
    <link rel="stylesheet" type="text/css"
        href="{!$Resource.SDEFStyles}/ReqDefPage.css" />
    
    <apex:outputPanel id="mappingDataPanel">
        <script>
            //Array store for process comboBox on Mappings tab
            var processOptionData = [{!ProcessOptions}];

            //Array store for request input grid
            var questionData = [{!RequestPrompts}];
        </script>
    </apex:outputPanel>
    <!-- Data for Request Fulfillment Tab and List Views-->
    <apex:outputPanel id="processTemplateStore">
        <script>
           /*
             Request Process/template data setup, populate data store for process grid         
           */
        
            var processData;            
            var disableReorderBTN;
            function setProcessData() {
              	disableReorderBTN ='{!disableReorderBTN}';
                processData = [{!ProcessTemplates}];
                setProcessDataStore(processData);
                setProcessOptionStore(processOptionData);
            } 
        </script>
     </apex:outputPanel>
     <apex:outputPanel id="requestInputStore">
        <script>
            /*
                Request input data setup,  populate data store for request input grid         
            */
            var inputData;
            var isrichTextAreapresent;
            function setInputData() {
                inputData = [{!processInputs}];
                isrichTextAreapresent={!isrichTextAreapresent};
                setInputDataStore(inputData);
                setQuestionDataStore(questionData);
				selectClickedRow();
            }
        </script>
     </apex:outputPanel>
    
     <apex:outputPanel id="processVarStore">
        <script>
            var processVarData = [];
           
           
           function setProcessVarData() {
                processVarData = [{!reqDefBean.processVarData}]; 
                setProcessVarDataStore(processVarData);
            } 
        </script>
        
     </apex:outputPanel>

      <apex:outputPanel id="inputMappingStore">
        <script> 
            var mappingData = [];
            function setInputMappingData() {
                mappingData = [{!inputMappings}];
                setInputMappingDataStore(mappingData);
            }
            
        </script>
        
     </apex:outputPanel>
     
     <apex:outputPanel id="offeringClausePanel">
        <script>
            isReqDefDeleted = {!isReqDefDeleted};
            errormsg = '{!JSENCODE(reqDefBean.messageString)}'; 
            var OfferingClause = null;
            var fkService = '{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
            var fkServiceField ='';
            var fkServiceEle;
            
            if(!isFlattenedCmdb){
            	fkServiceEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BusinessService__c_id_instance_name__c}');
            }else{
            	fkServiceEle = document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
            } 
			if(fkServiceEle!=null){
				fkServiceField = fkServiceEle.value; 
			}
			
			if(!isFlattenedCmdb){
	            if((fkService != null && fkService != '') || (fkServiceField != null && fkServiceField != '') ){
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
	            }else{
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (end_date__c = null or end_date__c >=' + dateValue + ') AND FKBMC_BaseElement__r.MarkAsDeleted__c = false');
	            }
            }else{
            	if((fkService != null && fkService != '') || (fkServiceField != null && fkServiceField != '') ){
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (FKBusinessService__c =\'' + fkService + '\')  And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
	            }else{
	                OfferingClause = escape('(serviceType__c = \'Offering\') And (enddate__c = null or enddate__c >=' + dateValue + ') AND MarkAsDeleted__c = false');
	            }				
            }
			
			if(isFlattenedCmdb){
				var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}'); 
				if(tempEl!=null&&serviceName!=tempEl.value){ 
                   clearOffering(); 
                   serviceName=tempEl.value; 
				} 
             }
        </script>
        
     </apex:outputPanel>
    <!-- .End of Data for Request Fulfillment Tab and List Views-->
    <apex:form id="ReqDefForm">
        <c:TabOutComponent ></c:TabOutComponent>
        <c:ValidationComponent errorMsgList="{!reqDefBean.messageString}"
            id="validationComponent"></c:ValidationComponent>
        <apex:actionFunction action="{!getSearchAccounts}"
            name="getSearchAccounts"
            rerender="EntitlementScript" oncomplete="loadLeftData();">
            <apex:param assignTo="{!searchString}" name="searchstring" value="" />
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />
        </apex:actionFunction>        
        <apex:actionFunction action="{!nextAccounts}" 
            name="nextAccounts"
            rerender="EntitlementScript" oncomplete="loadLeftData();">  
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />          
        </apex:actionFunction>
        <apex:actionFunction action="{!prevAccounts}"
            name="prevAccounts"
            rerender="EntitlementScript" oncomplete="loadLeftData();">            
            <apex:param assignTo="{!accRightStoreData}" name="rightData" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedBusinessService}"
            name="setBusinessService"
            rerender="BMC_BusinessService__c_id_instance_name__c,BMC_BusinessService__c_id_fkbmc_baseelement__c,BMC_BaseElement__c_id_name__c,BMC_BaseElement__c_id_id,offeringClausePanel,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedServiceOffering}"
            name="setServiceOffering"
            rerender="BMC_BusinessService__c_id_instance_name__c__x_1, BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c__x_1,BMC_BaseElement__c_id_id__x_1,CustomerPrice__c, DeliveryCost__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c, CostOption1__c, CostOption2__c, PriceOption1__c, PriceOption2__c, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:actionFunction action="{!setSelectedDoc}" name="setReqDefDoc"
            rerender="Image_Id" oncomplete="">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>

        <apex:actionFunction name="save" action="{!save}"
            reRender="afterSavePanel,validationComponent,apexMessageErrorPanel, processTemplateStore, ReqDef_DirectLink, requestInputStore, inputMappingStore, mappingDataPanel, customerPriceCurrency,deliveryCostCurrency,ReqDef_Description_RichText"
            onComplete="enablebtn();showError();setProcessData();updateProcessOptions();setInputData();setInputMappingData();setBtnState();updateTitle();assignApexErrorMessage();handleSave();">
            <apex:param assignTo="{!reqDefBean.reqDefObj.Inactive__c}"
                name="savedName" value="" />
			<apex:param assignTo="{!reqDefBean.fkLookupId}" name="LKfilterId" value="" />	
        </apex:actionFunction>

        
        <apex:actionFunction name="deleteReqDefObj" action="{!deleteReqDef}" rerender="offeringClausePanel" oncomplete="closeWindow();"/>
        <apex:actionFunction name="resetReqDefObj" action="{!reset}" rerender="SYSTemplate__c_id__inc_name,SYSTemplate__c_id__inc_id,targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c, 
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, ReqDef_DirectLink,  OptionsTab, EntitlementScript, allAccount, allProfile,isApprovalReqd,
                    processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, afterSavePanel, SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();setInactiveAndAttachmentChkBox();">
        </apex:actionFunction>
        
        <apex:actionRegion >
        <apex:actionFunction name="previousReqDef" action="{!previous}" rerender="targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c, 
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, ReqDef_DirectLink, OptionsTab, EntitlementScript, allAccount, allProfile,isApprovalReqd,
                    processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, afterSavePanel, SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();window.parent.changeTitle(getWID(),newTitle,newTitle);handleSave();addInputBtnHandler();setInactiveAndAttachmentChkBox();">
            <apex:param assignTo="{!reqDefBean.tempString}" name="idSetString" value=""/> 
        </apex:actionFunction>
        
        <apex:actionFunction name="nextReqDef" action="{!next}" rerender="targetInDays, targetInHours, ReqDef_Title, ReqDef_Description, BMC_BusinessService__c_id_instance_name__c, BMC_BusinessService__c_id_fkbmc_baseelement__c, BMC_BusinessService__c_id_instance_name__c__x_1, 
                    BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1,BMC_BaseElement__c_id_name__c, BMC_BaseElement__c_id_id, BMC_BaseElement__c_id_name__c__x_1, 
                    BMC_BaseElement__c_id_id__x_1, Category__c_id_name, Category__c_id_id, Category__c_id_fkurgency__c, CustomerPrice__c, PriceOption1__c, PriceOption2__c, DeliveryCost__c, 
                    CostOption1__c, CostOption2__c, RequestDefinition__c_id_StartDate__c, RequestDefinition__c_id_EndDate__c, 
                    Image_Id, RequestDefinition_Status, RequestDefinition_Online, ReqDef_DirectLink, OptionsTab, EntitlementScript, allAccount, allProfile,isApprovalReqd,
                    processTemplateStore, requestInputStore, processVarStore, inputMappingStore,mappingDataPanel, SRM_RequestDefinition_userInstructions__c, afterSavePanel, SYSTemplate__c_id_name, SYSTemplate__c_id_id,customerPriceCurrency,deliveryCostCurrency" 
                    oncomplete="setTurnaroundTime();resetEntitlementData();callToggleAccountSelector();callEntitlementSelector();setProcessData();setInputData();setProcessVarData();setInputMappingData();resetProcessOption();window.parent.changeTitle(getWID(),newTitle,newTitle);handleSave();addInputBtnHandler();setInactiveAndAttachmentChkBox();">
            <apex:param assignTo="{!reqDefBean.tempString}" name="idSetString" value=""/> 
        </apex:actionFunction>
        </apex:actionRegion>
        <apex:actionFunction action="{!setServiceRequestTemplate}"
            name="setServiceRequestTemplate"
            rerender="SYSTemplate__c_id_name, SYSTemplate__c_id_id,SYSTemplate__c_id__inc_id,SYSTemplate__c_id__inc_name,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();">
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
         <apex:actionFunction action="{!setIncidentTemplate}"
            name="setIncidentTemplate"
            rerender="SYSTemplate__c_id__inc_id,SYSTemplate__c_id__inc_name,apexMessageErrorPanel" oncomplete="assignApexErrorMessage();var INCValue = getIncValue();onCompleteSetIncident(INCValue);"> 
            <apex:param assignTo="{!savedID}" name="savedID" value="" />
        </apex:actionFunction>
        <apex:inputHidden id="targetInDays" value="{!reqDefBean.targetInDays}" />
        <apex:inputHidden id="targetInHours" value="{!reqDefBean.targetInHours}" />
        <!-- <apex:inputHidden id="cPriceInUSD" value="{!reqDefBean.cPriceInUSD}" />
        <apex:inputHidden id="dPriceInUSD" value="{!reqDefBean.dPriceInUSD}" />  -->

        <div id="capsule" class="clsCapsule">
        <table cellpadding="0" cellspacing="0" class="clsMainTable" >

            <!-- Button toolbar row -->
            <tr class="clsRowGreyBg">
                <td colspan="2">
                <div id="btnToolbar"></div>
                </td>
            </tr>

            <tr>
                <!-- <div id='ReqDef_TabPanel' style='border: 1px solid #999999;'>  -->
            
                <apex:outputPanel id="tablePanel">
                    <table cellpadding="0" cellspacing="0" class="clsTable">
                        <tr>
                            <td colspan="3">
                            <div class="div15pxVspacing" />
                            </td>
                        </tr>
                        <tr>
                            <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__serviceRequestTitle__c.label}" />
                            <span class="clsRequiredBlack">&nbsp;*</span></td>
                            <td class="clsInputTextBoxTD1 "><apex:inputText value="{!reqDefBean.reqDefObj.BMCServiceDesk__serviceRequestTitle__c}" id="ReqDef_Title" StyleClass="clsInputTextBox2 clsLeftPadTD5px"/></td>
                       
                            <td class="clsInputLabelTD1"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Description__c.label}" /></td>
                            <td class="clsLeftPadTD5px clsBottomPadTD3px clsInputTextAreaTD2">
                            <apex:inputTextArea value="{!reqDefBean.reqDefObj.BMCServiceDesk__Description__c}" disabled="false"
                                id="ReqDef_Description"
                                StyleClass="clsInputTextFieldRel1" tabindex="2" /></td>
                            <td class="TextboxPopupIconTD" style="width: 22px;">                            
                            <div class="TextboxPopupIconDiv">
                                <input type="button"
                                class="TextboxPopupIcon" style="cursor:pointer;"
                                onclick="showTextEditor('{!$Component.ReqDefForm.ReqDef_Description}', '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.Description__c.label)}',32000, labelOK , labelCancel);" />                                                               
                            </div>
                            </td>                            	
                            <td class="clsPadding5TD clsPaddingRight5TD">
                            	<apex:inputHidden id="ReqDef_Description_RichText" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Description_Rich_Text__c}"/>
                          		<input type="button"
                                    class="changeBtnCls" style="cursor:pointer;height: 19px;"
                                    title="{!$Label.Rich_Text_Description}" value="{!$Label.Rich_Text_Description}"
                                    onclick="if(!inProgress){
                                    	var winWidth = 0;
                                    	if(window.innerWidth == 'undefined' || window.innerWidth == undefined){
											winWidth = document.documentElement.offsetWidth;
										}
										else
											winWidth = window.innerWidth;
										if(winWidth > 1000)
											winWidth = 930;
                                        if(recordID != ''){
                                            openRichTextPopup('ReqDefDescription?id='+recordID ,setBusinessService, '{!JSENCODE($Label.Rich_Text_Description)}', 617, winWidth-24);
                                        }
                                        else{
                                            openRichTextPopup('ReqDefDescription',setBusinessService, '{!JSENCODE($Label.Rich_Text_Description)}', 617, winWidth-24);
                                        }
                                        }" />
                            </td>
                        </tr>
                    </table>
                </apex:outputPanel>
                <table cellpadding="0" cellspacing="0">
                    <tr>
                        <td height="14"></td>
                    </tr>
                    <tr id="TabButtons">
                        <td class="clsPadding5TD"><input type="button"
                            id="ReqDef_GeneralInfo" class="changeBtnCls"
                            title="{!$Label.SLM_General_Information}" value="{!$Label.SLM_General_Information}"
                            onclick="displayActiveTab(this);" /></td>
                        <td class="clsPadding5TD"><input type="button"
                            id="ReqDef_Entitlement" class="changeBtnCls" title="{!$Label.Entitlement}"
                            value="{!$Label.Entitlement}" 
                            onclick="displayActiveTab(this);" /></td>
                        <td class="clsPadding5TD"><input type="button"
                            id="ReqDef_Options" class="changeBtnCls" title="{!$Label.DisplayOptions}"
                            value="{!$Label.DisplayOptions}"
                            onclick="displayActiveTab(this);" /></td>
                        <td class="clsPadding5TD"><input type="button"
                            id="ReqDef_Input" class="changeBtnCls" title="{!$Label.InputNameLabel}"
                            value="{!$Label.InputNameLabel}" onclick="displayActiveTab(this);" /></td>
						<td class="clsPadding5TD"><input type="button"
                            id="ReqDef_Fulfillment" class="changeBtnCls" title="{!$Label.Fulfillment}"
                            value="{!$Label.Fulfillment}" onclick="displayActiveTab(this);" /></td>
                    </tr>
                    <tr>
                        <td height="6"></td>
                    </tr>
                </table>
                
                <div id='ReqDef_GeneralInfoTab' class="clsGeneralInfoTab">
                <table width="900px" cellpadding="0" cellspacing="0">
                    <tr>
                        <td height="15"></td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}" /><span 
                        class="clsRequiredBlack">&nbsp;*</span></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="clsInputTextBoxTD">
                                	<apex:outputpanel rendered="{!NOT(isFlattenedCmdb)}">
                                        <apex:inputText title="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}" id="BMC_BusinessService__c_id_instance_name__c" value="{!reqDefBean.businessServiceName}" styleClass="clsIdInputTextBox" onblur="showalldata(event,setofferingClausePanelData,dateClause);" />
                                    	<apex:inputHidden id="BMC_BusinessService__c_id_fkbmc_baseelement__c" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKBusinessService__c}"/>
                                    </apex:outputpanel>
                                    <apex:outputpanel rendered="{!isFlattenedCmdb}">
                                        <apex:inputText title="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKBusinessService__c.label}" id="BMC_BaseElement__c_id_name__c" value="{!reqDefBean.businessServiceName}" styleClass="clsIdInputTextBox" onblur="showalldata(event,setofferingClausePanelData,dateClause);if(this.value=='')clearOffering();" />
                                    	<apex:inputHidden id="BMC_BaseElement__c_id_id" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKBusinessService__c}"/>
                                    </apex:outputpanel>
                                </td>
                                <td>
                                <div class="lookUpIconDiv"><input
                                    id="businessserviceLookup" type="button"
                                    onclick="if(!inProgress){openPopupRF('SearchPage?popupId=BMC_BusinessService&isLookup=true&filterClause=' + dateClause ,setBusinessService)}"
                                    class="lookupIconOn" /></div>
                                </td>
						<td id="businessservicequicklink"  class="quickLinkCls">
                             <apex:outputpanel rendered="{!isFlattenedCmdb}">
                                 <input type="button" class="createNewCls" title = "{!$Label.Create_New} {!$Label.BusinessService}" onclick="setServiceName();createnewserviceoffering('BusinessService',setBusinessService)"/>
                             </apex:outputpanel>
                         </td>
                    </tr>
                        </table>
                        </td>
                       
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}" /><span
                            class="clsRequiredBlack">&nbsp;*</span></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="clsInputTextBoxTD">
                                	<apex:outputpanel rendered="{!NOT(isFlattenedCmdb)}">
                                        <apex:inputText title="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}" id="BMC_BusinessService__c_id_instance_name__c__x_1" value="{!reqDefBean.ServiceOfferingName}" styleClass="clsIdInputTextBox" onblur="showalldata(event,setBusiOffering,OfferingClause);" /> 
                                    	<apex:inputHidden id="BMC_BusinessService__c_id_fkbmc_baseelement__c__x_1" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKServiceOffering__c}"/>
                                    </apex:outputpanel>
                                    <apex:outputpanel rendered="{!isFlattenedCmdb}">
                                        <apex:inputText title="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKServiceOffering__c.label}" id="BMC_BaseElement__c_id_name__c__x_1" value="{!reqDefBean.ServiceOfferingName}" styleClass="clsIdInputTextBox" onblur="showalldata(event,setBusiOffering,OfferingClause);" /> 
                                    	<apex:inputHidden id="BMC_BaseElement__c_id_id__x_1" value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKServiceOffering__c}"/>
                                    </apex:outputpanel>
                                </td>
                                <td>
                                <div class="lookUpIconDiv"><input
                                    id="businessserviceLookup" type="button"
                                    onclick="if(!inProgress){setofferingClausePanelData();openPopupRF('SearchPage?popupId=BMC_BusinessService&isLookup=true&filterClause='+OfferingClause,setServiceOffering)}"
                                    class="lookupIconOn" /></div>
                                </td>
						<td id="serviceoffquicklink" class="quickLinkCls">
                           <apex:outputpanel rendered="{!isFlattenedCmdb}">
                               <input type="button"  title="{!$Label.Create_New} {!$Label.ServiceOffering}" class="createNewCls" onclick="setSubServiceId();createnewserviceoffering('ServiceOffering',setServiceOffering)" />
                           </apex:outputpanel>
                        </td>
                    </tr>
                        </table>
                        </td>
                        
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}" /><span
                            class="clsRequiredBlack">&nbsp;*</span></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="clsInputTextBoxTD"><apex:inputText title="{!JSENCODE($Label.bmcservicedesk__select)} {!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__FKCategory__c.label}"
                                    id="Category__c_id_name" value="{!reqDefBean.categoryName}"
                                    styleClass="clsIdInputTextBox" onBlur="showalldata(event,null,escape('inactive__c = false and AvailableForServiceCatalog__c=true'));" />
                                <apex:inputhidden id="Category__c_id_id"
                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__FKCategory__c}" /><apex:inputhidden id="Category__c_id_fkurgency__c" /></td>
                                <td>
                                <div class="lookUpIconDiv"><input type="button"
                                    id="RequestDefinitionLookup"
                                    onclick="if(!inProgress){openPopupRF('CategorySearchPage?isLookup=true&isSD=true&isRequestCatalog=true&categoryview=SR&filterClause='+ escape('inactive__c = false'),openCategoryLookup);}"
                                    class="lookupIconOn" /></div>
                                </td>
                                <td style="min-width: 150px;padding-left: 10px;">
                                   <input type="button" class="createNewCls" title= "{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.AdminCategory)}" id="AddNewCategory" onclick="openCreateNewPopup('Category');"/>   
                                </td>
                            </tr>
                        </table>
                        </td>
                    </tr>
                    <!-- Incident Template Lookup -->
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__incidenttemplate}" /><span
                            class="clsRequiredBlack">&nbsp;*</span></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="clsInputTextBoxTD"><apex:inputText value="{!reqDefBean.IncidentTemplateName}"
                                    id="SYSTemplate__c_id__inc_name" title="{!JSENCODE($Label.bmcservicedesk__select)} {!JSENCODE($Label.bmcservicedesk__incidenttemplate)}"
                                    styleClass="clsIdInputTextBox" onblur="fetchDataForInc(event);" onchange="clearAssociatedIdsInc();"/>
                                <apex:inputhidden id="SYSTemplate__c_id__inc_id" value="{!reqDefBean.IncidentTemplateId}"/></td>
                                <td>
                                <div class="lookUpIconDiv"><input type="button"
                                    id="IncidentTemplateLookup"
                                    onclick="openIncPopup();"
                                    class="lookupIconOn" /></div>
                                </td>
                                <td style="min-width: 150px;padding-left: 10px;">
                                    <input type="button" class="createNewCls" title="{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.IncidentTemplate)}" onclick="openCreateNewPopup('INC Template');"/>
                                </td>
                            </tr>
                        </table>
                        </td> 
                    </tr>
                    <!-- Service Request Template Lookup -->
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__servicerequesttemplatelookuplabel}" /><span
                            class="clsRequiredBlack">&nbsp;*</span></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="clsInputTextBoxTD"><apex:inputText title="{!$Label.bmcservicedesk__servicerequesttemplatelookuphelptext}"
                                    id="SYSTemplate__c_id_name" value="{!reqDefBean.serviceReqTemplateName}"
                                    styleClass="clsIdInputTextBox" onblur="fetchDataForSR(event);" onchange="clearAssociatedIdsSR();"/> 
                                <apex:inputhidden id="SYSTemplate__c_id_id"
                                    value="{!reqDefBean.serviceReqTemplateObj.BMCServiceDesk__FKTemplate__c}" /></td>
                                <td>
                                <div class="lookUpIconDiv"><input type="button"
                                    id="ServiceReqTemplateLookup"
                                    onclick="searchlookupforRDTemplate();"
                                    class="lookupIconOn" /></div>
                                </td>
                                <td style="min-width: 180px; padding-left: 10px;">
                                    <input type="button" class="createNewCls" title="{!$label.Create_New_Request_Defination_Template}" onclick="openCreateNewPopup('SR Template');"/>   
                                </td>
                            </tr>
                        </table>
                        </td> 
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD clsInputfixedLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__CustomerPrice__c.label}" />
                        </td>
                        <td>
                        <table cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td class="clsInlineHelpTD" title="{!$ObjectType.SRM_RequestDefinition__c.fields.CustomerPrice__c.inlineHelpText}">
                                    <apex:inputfield styleClass="reqDefclsInputTextBox" value="{!reqDefBean.reqDefObj.BMCServiceDesk__CustomerPrice__c}" id="CustomerPrice__c" />
                                </td>
                                <td class="clsCurrencyTD">  
                                    <apex:outputLabel id="customerPriceCurrency" styleClass="reqDefclsInputLabelTD" value="{!currencyUsed} /" />
                                </td>
                                <td class="clsPrice1TD"><apex:inputfield styleClass="clsRequestDefSelectList"
                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__PriceOption1__c}"
                                    id="PriceOption1__c" /><apex:outputLabel value="/" /></td>
                                <td class="clsPrice2TD"><apex:inputfield styleClass="clsRequestDefSelectList"
                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__PriceOption2__c}"
                                    id="PriceOption2__c" /></td>
                            </tr>
                        </table>
                    </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD clsInputfixedLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__DeliveryCost__c.label}" />
                        </td>
                        <td>
                        <table cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td class="clsInlineHelpTD" title="{!$ObjectType.SRM_RequestDefinition__c.fields.DeliveryCost__c.inlineHelpText}">
                                    <apex:inputfield styleClass="reqDefclsInputTextBox" value="{!reqDefBean.reqDefObj.BMCServiceDesk__DeliveryCost__c}" id="DeliveryCost__c" />
                                </td>
                                <td class="clsCurrencyTD">
                                    <apex:outputLabel id="deliveryCostCurrency" styleClass="reqDefclsInputLabelTD" value="{!currencyUsed} /" />
                                </td>
                                <td class="clsPrice1TD"><apex:inputfield styleClass="clsRequestDefSelectList"
                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__CostOption1__c}"
                                    id="CostOption1__c" /><apex:outputLabel value="/" /></td>
                                <td class="clsPrice2TD"><apex:inputfield styleClass="clsRequestDefSelectList"
                                    value="{!reqDefBean.reqDefObj.BMCServiceDesk__CostOption2__c}"
                                    id="CostOption2__c" /></td>
                            </tr>
                        </table>
                        </td>
                    </tr>

                    <tr>
                        <td class="clsInputLabelTD clsInputfixedLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__TurnaroundTime__c.label}" /></td>
                        <td>
                        <table cellpadding="0" cellspacing="0">
                            <tr>
                                <td class="days-label-td" 
                                    title="{!$ObjectType.SRM_RequestDefinition__c.fields.TurnaroundTime__c.inlineHelpText}">
                                <div id="days-ct" /><apex:outputLabel StyleClass="clsLabelHistoryDays" value="{!$Label.bmcservicedesk__incidenthistorydays}" />
                                </td>
                                <td class="hours-label-td" 
                                    title="{!$ObjectType.SRM_RequestDefinition__c.fields.TurnaroundTime__c.inlineHelpText}">
                                <div id="hours-ct" /><apex:outputLabel StyleClass="clsBottomPadTD" value="{!$Label.bmcservicedesk__hourslabel}" />
                                </td>
                            </tr>
                        </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__StartDate__c.label}" />
                        </td>
                        <td class="clsInputTextBoxTD"
                            title="{!$ObjectType.SRM_RequestDefinition__c.fields.StartDate__c.inlineHelpText}">
                        
                            <apex:inputField value="{!reqDefBean.reqDefObj.BMCServiceDesk__StartDate__c}"
                                id="RequestDefinition__c_id_StartDate__c"
                                StyleClass="clsInputTextBox1 clsLeftPadTD5px"/>
                        </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__EndDate__c.label}" />
                        </td>
                        <td class="clsInputTextBoxTD"
                            title="{!$ObjectType.SRM_RequestDefinition__c.fields.EndDate__c.inlineHelpText}">
                        
                            <apex:inputField value="{!reqDefBean.reqDefObj.BMCServiceDesk__EndDate__c}"
                                id="RequestDefinition__c_id_EndDate__c"
                                StyleClass="clsInputTextBox1 clsLeftPadTD5px"/>
                        </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__SRDUrl__c.label}" />
                        </td>
                        <td class="clsInputTextBoxTD"
                            title="{!$ObjectType.SRM_RequestDefinition__c.fields.SRDUrl__c.inlineHelpText}">
                        
                            <apex:inputText value="{!reqDefBean.reqDefObj.BMCServiceDesk__SRDUrl__c}"
                                id="RequestDefinition__c_id_SRDUrl__c"
                                 StyleClass="clsIdInputTextBox" />
                        </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Image__c.label}" /></td>
                        <td>
                        <table cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td width="25%" class = "clsBottomPadTD">
                                    <table cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td class="clsImageTD">
                                                <div id="enclosingDiv"  >
                                                    <apex:image value="/servlet/servlet.FileDownload?file={!reqDefBean.reqDefObj.BMCServiceDesk__Image__c}"  id="Image_Id" height="90" width="111px"  />

                                                   <image id="someImage" src="" class="clsImage" onError="ImgError(this)"/>
                                                </div> 
                                                
                                                <script>
                                                
                                                    document.getElementById('someImage').src='/';
                                                    if(!'{!JSENCODE(reqDefBean.reqDefObj.Image__c)}')
                                                    document.getElementById('thePage:ReqDefForm:Image_Id').style.display='none';
                                                 </script>
                                            </td>
                                        </tr>
                                    </table>        
                                </td>
                                <td  class = "clsBottomPadTD1">
                                <table cellpadding="0" cellspacing="0" width="100%">
                                    <tr>
                                        <td valign="Top">
                                         <table>
                                         <tr>
                                          <td valign="Top">
                                            <input type="radio" name="selectRadio" id="radioCom" onclick="document.getElementById('radioSF').checked = false;"/>
                                            <apex:outputLabel styleClass="clsInputLabelTD" value="{!$Label.bmcservicedesk__selectfromcomputer}" />
                                          </td>
                                          </tr>
                                          <tr>
                                          <td ><input type="radio" checked="true" name="selectRadio" id="radioSF" onclick="document.getElementById('radioCom').checked = false;" />
                                            <apex:outputLabel styleClass="clsInputLabelTD" value="{!$Label.bmcservicedesk__selectfromsalesforce}"/>
                                             </td>
                                             </tr>
                                             <tr>
                                            <td>
                                            
                                            <input class="selectBtnCls" type="button" value="{!$Label.SelectButton}" onclick="openImagePopup();"/>
                                        </td>
                                        </tr>
                                            
                                            </table>
                                            </td>
                                    </tr>
                                    <!--  <tr>  
                                        <td ><input type="radio" id="radioSF" onclick="document.getElementById('radioCom').checked = false;" />
                                            <apex:outputLabel styleClass="clsInputLabelTD" value="Select From Salesforce"/> </td>
                                        
                                    </tr>
                                       <tr>
                                        <td height="35px">
                                        </td>
                                    </tr>   
                                    <tr>
                                        <td>
                                            <input class="selectBtnCls" type="button" value="Select..." onclick="openImagePopup();"/>
                                        </td>   
                                    </tr> -->
                                </table>
                                </td>
                            </tr>
                        </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="clsInputLabelTD clsInputfixedLabelTD">
                            <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Status__c.label}" />
                        </td>
                        <td class="clsInputTextBoxTD">
                            <apex:inputfield value="{!reqDefBean.reqDefObj.BMCServiceDesk__Status__c}" id="RequestDefinition_Status" styleClass="clsRequestDefSelectList1" />
                        </td>

                    </tr>
                    <tr>
                        <td class="clsPanelInputCheckboxTDSA clsInputLabelTD clsRequestDefOnlineTD" colspan="2">
                            <apex:inputCheckbox title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Online__c.inlineHelpText}" id="RequestDefinition_Online" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Online__c}"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Online__c.label}" /> 
                        </td>
                    </tr>
                    <tr>
                         <td class='clsPanelInputCheckboxTDSA clsInputLabelTD clsApprovalRequiredTD'  colspan="2">
                               <apex:inputcheckbox value="{!reqDefBean.reqDefObj.BMCServiceDesk__ApprovalRequired__c}" id="isApprovalReqd" />
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__approvalrequired}"/>
                        </td>
                    </tr>
					<tr>
                         <td class='clsPanelInputCheckboxTDSA clsInputLabelTD clsApprovalRequiredTD'  colspan="2">
                            <apex:inputcheckbox value="{!reqDefBean.reqDefObj.BMCServiceDesk__Mobile__c}" id="isMobile" title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Mobile__c.inlineHelpText}" />
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__Mobile__c.label}"/>
                        </td>
                    </tr>
                    <tr id="ReqDef_DirectLinkTR" style="display:none;">
                        <td class="clsInputLabelTD">
                   	    	<apex:outputLabel value="{!$Label.bmcservicedesk__selfservicelink}"/>
                        </td>
                        <td class="clsInputTextBoxTD">
                   			<apex:outputPanel id="ReqDef_DirectLink" layout="none"> 
                        		<apex:inputText value="{!reqDefBean.directLink}" id="ReqDef_DirectSSLink" styleClass="clsInputTextBoxReadOnly" title="{!$Label.bmcservicedesk__directlinksrinfo}" onkeypress="return false;" onclick="this.select();"/>
                   			</apex:outputPanel>
                        </td>
                    </tr>
                </table>
                </div>
                
                <div id='ReqDef_EntitlementTab' class="clsEntitlemenetTab">
                                <table class="clsEntitlementTable">
                                    <tr>
                                        <td class="clsBoldInputLabelTD">
                                            <apex:outputLabel value="{!$Label.bmcservicedesk__accountentitlement}"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <apex:selectRadio value="{!reqDefBean.reqDefObj.BMCServiceDesk__AllAccounts__c}" id="allAccount" layout="pageDirection" styleClass="checkLabel" label="{!$Label.bmcservicedesk__allaccountsentitlement}" onclick="toggleAccountSelector(this.value);">
                                            <apex:selectOptions value="{!accountOptions}"/>
                                        </apex:selectRadio>                                     
                                    </tr>
                                    <tr>
                                            <div id='toolBar' class="clsMarginLeftTD" ></div>
                                    </tr>
                                    <table class="clsclsAvailableTableAccounts1">
                                        <tr>
                                            <table class="clsAvailableTableAccounts">
                                                <tr>
                                                    <td width="300px" class="clsBoldInputLabelTD">
                                                        <apex:outputLabel value="{!$Label.bmcservicedesk__availableaccounts}"/>
                                                    </td>
                                                    <td class="clsBoldInputLabelTD">
                                                        <apex:outputLabel value="{!$Label.bmcservicedesk__selectedaccounts}"  />
                                                    </td>
                                                </tr>
                                            </table>
                                        </tr>
                                        
                                        <tr>
                                            <div id='accountSelectorDiv' class="clsMarginLeftTD"></div>
                                            <apex:inputHidden id="selectedAccounts" value="{!reqDefBean.selectedAccounts}" />
                                        </tr>
                                    </table>
                                    <table class="clsTable2">
                                        <tr></tr>
                                    	<tr></tr>
                                        <tr>
                                            <td class="clsBoldInputLabelTD">
                                                <apex:outputLabel value="{!$Label.bmcservicedesk__profileentitlement}"/>
                                            </td>
                                            <td> </td>
                                            <td>
                                                <apex:selectList value="{!reqDefBean.entiltementOption}" multiselect="false" size="1" id="entitlementOption" onclick="entitlementSelector(this.value);">
                                                	<apex:selectOptions value="{!EntitlementOptions}" />
                                            	</apex:selectList>      
                                            </td>
                                        </tr>
                                        <tr></tr>
                                        <table style="padding-left:1%">
                                            <tr>
                                                <td style="width:20px;" valign="top">
                                                     <img src="{!$Resource.Themes}/SSDefaultTheme/images/en_US/SS_Information_16.png"/>
                                                </td>
                                                <td class="mapInstrucntionCls" valign="top">
                                                    <apex:outputLabel value="{!$Label.bmcservicedesk__entitlementinstructions}" />
                                                </td>
                                        	</tr>
                                            <tr></tr>
                                            <tr></tr>
                                        </table>
                                            
                                        <tr></tr>
                                        <tr>
                                            <table class="clsAvailableTableAccounts">
                                                <tr>
                                                    <td width="300px" class="clsBoldInputLabelTD">
                                                        <apex:outputLabel id="available" value="{!$Label.bmcservicedesk__availableprofile}"/>
                                                    </td>
                                                    <td class="clsBoldInputLabelTD">
                                                        <apex:outputLabel id="selected" value="{!$Label.bmcservicedesk__selectedprofile}"  />
                                                    </td>
                                                </tr>
                                            </table>
                                        </tr>
                                        <tr>
                                            <div id='profileSelectorDiv' class="clsMarginLeftTD"></div>
                                            <apex:inputHidden id="selectedProfiles" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Profiles__c}" />
                                        </tr>
                                    </table>                                           
                                    
                                    
                                   
                                </table>
                            </div>
                <div id='ReqDef_FulfillmentTab' class="clsFulfillmentTab" >
                	<table width="659" cellpadding="0" cellspacing="0" border="0">
                      <tr>
                        <td></td>
                      </tr>
                    </table>
                    <table cellspacing="0" cellpadding="0" width="100%" border="0" id="inputMappingDiv" class="clsEntitlementTable">
                    	<tr>
							<td class="clsBoldInputLabelTD" colspan="3" valign="top">
								<apex:outputLabel value="{!$Label.bmcservicedesk__fulfillment_criteria_ci_asset}" />
								<img class="RDFullfilmentImg" src="{!$Resource.Themes}/SSDefaultTheme/images/en_US/SS_Information_16.png" title="{!$Label.FulfillmentCriteriaInstructions}"/>
							</td>
						</tr>
						<tr>
							<td colspan="3" valign="top" style="padding-top: 5px;padding-bottom: 25px;" class="mapInstrucntionCls">
								<a id="PopupLink" value="#" onclick="FulfillmentCriteriaHandler();"></a>
								<a id="DeleteLink" value="#" onclick="waitbox(0);deleteFulfillmentCriteria(LKfilterId);" style="display:none;">{!$Label.Delete}</a>
								<apex:outputLabel value="{!$Label.bmcservicedesk__rule_criteria}" style="padding-left: 5px;"/>
								<apex:outputPanel id="criteriaTextDiv">
                                <textarea id="CriteriaText" cols="100" class="CriteriaTextClass" disabled="true">{!QueryCondition}</textarea>
								</apex:outputPanel>	
							</td>
						</tr>
						<tr>
							<td valign="top" colspan="3" class="clsBoldInputLabelTD">
								<apex:outputLabel value="{!$Label.bmcservicedesk__add_fulfillment_templates}" />
							</td>
                        </tr>
                    	<tr>
							<td valign="top" colspan="3"><div id="processGrid" style="width:98%"></div></td>
                        </tr>
                        <tr>
							<td valign="top" colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
							<td valign="top" colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
							<td valign="top" colspan="3" class="clsBoldInputLabelTD">
								<apex:outputLabel value="{!$Label.bmcservicedesk__map_user_inputs_to_template_fields}" />
							</td>
                        </tr>
                        <tr>
							<td valign="top" colspan="3">&nbsp;</td>
                        </tr>                       
                        
                        <tr>
                        	<td valign="top" colspan="3">
                                <apex:outputPanel layout="block" style="margin-left: -1px;">
                                    <table>
                                        <tr>
                                            <td class="mapInstrucntionCls" valign="middle">
                                                <apex:outputLabel value="{!$Label.bmcservicedesk__selectprocess}" />
                                            </td>
                                            <td style="padding-left: 10px; min-width: 200px;">
                                            	<div id="processOptionsCombo"></div>
                                            </td>
											<td width="30px"/>
                                            <td colspan="2" valign="top">
												<apex:inputCheckbox id="chkPrefixPrompt" value="{!reqDefBean.reqDefObj.BMCServiceDesk__Prefix_Prompt_to_user_input__c}"/>
											</td>
											<td valign="top" class="clsPadding5TD">
												<apex:outputLabel styleClass="mapInstrucntionCls" value="{!$Label.bmcservicedesk__prefixprompttouserinput}"/>
											</td> 
                                        </tr>
                                    </table>
                                </apex:outputPanel>         
                            </td>
                        </tr>
                        <tr>
							<td valign="top" colspan="3">&nbsp;</td>
                        </tr>
                        <tr>
                            <td align="left" colspan="3">
                                <table width="98%" max-width="975px">
                                    <tr>
                                        <td class="clsBoldInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__requestinputsource}" /></td>
                                        <td width="70px;">&nbsp;</td>
                                        <td align="left" class="clsBoldInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__processvariabletarget}" />
											<img class="RDFullfilmentImg" src="{!$Resource.Themes}/SSDefaultTheme/images/en_US/SS_Information_16.png" title="{!$Label.FulfillmentMappingInstructions}"/>
										</td>
                                    </tr>
                                    <tr>
                                        <td valign="top" style="width:45%"><div id="reqInputGrid"></div></td>
                                        <td width="70px;">&nbsp;</td>
                                        <td valign="top" style="width:45%"><div id="processVarGrid"></div></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" valign="top">
                                            <input id="addMappingBtn" type="button"  class="defaultBtn"  value="{!$Label.MapInputToField}" onclick="addFulfillmentMapping()" style="cursor:pointer" />
                                        </td>
                                    </tr>
                                </table>
                             </td>
                         </tr>
                         <tr>
                             <td  colspan="3" >
                                <div class="div15pxVspacing"></div>
                             </td>
                         </tr>
                         <tr>
                         	<td class="clsBoldInputLabelTD" valign="top" colspan="3">
                         		<apex:outputLabel value="{!$Label.bmcservicedesk__mapped_fields_for_selected_template}" />
                         	</td>
                         </tr>
                         <tr height="15px">
                            <td colspan="3">
                            	<div id="mappingGrid" style="width:98%"></div>
                            </td>
                         </tr>
                    </table>
                </div>
                <div id='ReqDef_InputTab' class="clsInputTab" >
                    <table width="659" cellpadding="0" cellspacing="0" border="0">
                      <tr>
                        <td></td>
                      </tr>
                    </table>
                    <table cellspacing="0" cellpadding="0" width="100%" border="0" id="inputListDiv" class="clsEntitlementTable">
                         <tr>
                            <td>
                                <table>
                                     <tr>
                                         <td colspan="2" class="clsBoldInputLabelTD" width="11%"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__UserInstructions__c.label}" /></td>
                                     
                                         <td width="88%">
                                             <div class="clsRelativePosition clsLeftPadTD5px">
                                                 <apex:inputTextarea title="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__UserInstructions__c.inlineHelpText}" id="SRM_RequestDefinition_userInstructions__c" value="{!reqDefBean.userInstructions}" styleClass="clsInputTextArea" tabindex="509" style="width:99% !important; height:25px !important;"/>
                                             </div>
                                         </td>
                                         <td class="clsInputTextAreaTD" valign="top" style="padding-left: 0px !important;">
                                             <input type="button" id="inputTxtAreaButton" class="TextboxPopupIcon" style="display:inline" onclick="showTextEditor('{!$Component.ReqDefForm.SRM_RequestDefinition_userInstructions__c}', '{!JSENCODE($ObjectType.SRM_RequestDefinition__c.fields.userInstructions__c.label)}', '32000', '{!JSENCODE($Label.OK)}', '{!JSENCODE($Label.Cancel)}');"/>
                                         </td>
                                     </tr>
                                </table>
                            </td>
                         </tr>
                         <tr height="15px">
                              <td>&nbsp;</td>
                         </tr>
                         <tr>
                            <td style="padding-right: 20px;">
                                <table cellspacing="0" cellpadding="0" border="0" width="100%">
                                  <tr>
                                        <td class="clsBoldInputLabelTD" colspan="3" >
                                            <apex:outputLabel value="{!$Label.bmcservicedesk__requestinput}" id="QVDescLabel"/>
                                        </td>
                                  </tr>
                                  <tr>
                                        <td style="vertical-align:top;" width="40%" id="tdRDInput"><div id="grid"></div></td>
                                        <td width="5px" class="expandedTd" id="tdToggleView" onmouseleave="mouseleavetdToggleView();" onmouseover="hovertdToggleView();" onclick="hideShowRDInputGrid();" title="{!JSENCODE($Label.Supporting_Hide)} {!JSENCODE($Label.the_Request_Input_List)}">
											<div class="collapseRDInput" id="divToggleView"></div></td>
                                        <td width="20px"/><td id="tdInputs" width="60%;" style="border: 1px solid #999999">
                                        	<iframe id="frameFulfillmentInput" src="" height="415px" width="100%" scrolling="yes" frameborder="0" /> 
                                            <table style="display:none;">
                                                <tr>
                                                <td>
                                                    <input id="btnUpId" type="button" class="btnArrowUpDisable" onclick="moveSelectedRow(-1)" disabled="disabled"/>
                                                </td>
                                                </tr>
                                                <tr>
                                                <td>
                                                    <input id="btnDownId" type="button" class="btnArrowDownDisable" onclick="moveSelectedRow(1)" disabled="disabled"/>
                                                </td>
                                                </tr>
                                            </table>
                                      </td>
                                  </tr>
                                </table>        
                            </td>
                       </tr>
                    </table>
                     <apex:inputhidden value="{!reqDefBean.reqDefObj.BMCServiceDesk__Set_Execution_Order__c}" id="RequestDefinition__c_id_Set_Execution_Order__c"/>
                </div>
                <div id='ReqDef_OptionsTab' class="clsOptionsTab">
                <apex:outputPanel id="OptionsTab">
                <table width="646" cellpadding="0" cellspacing="0" class="clsMarginLeftTD1">
                    <tr>
                        <td height="13" ></td>
                    </tr>
                    <tr>
                        <td height="9" ></td>
                    </tr>
                    
                    <!--  ############ Save & Edit functionality for this commented section is already implemented ################ --> 
                    
                         <tr>
                            <td class="clsBoldInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__reqdefreviewservice}"/></td>
                        </tr>
                        <tr>
                            <td> <apex:outputLabel value="{!$Label.bmcservicedesk__reviewinstruction}"/></td>
                        </tr>
                        <tr> 
                            <td height="6" ></td>
                        </tr>
					<tr>
						<td>	
						<table  width="70%">
							<tr>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefTurnTime" value="{!reqDefBean.turnAround}"/>
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefturnaroundtime}"/>
								</td>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefEmail" value="{!reqDefBean.email}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__email}"/>
								</td>
							</tr>
							<tr>
								<td height="2" colspan="2"></td>
							</tr>  
							<tr>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefPrice" value="{!reqDefBean.price}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefprice}"/>
								</td>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefInstructions" value="{!reqDefBean.instructions}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__instructions}"/>
								</td>
							</tr>
							<tr>
								<td height="2" colspan="2"></td>
							</tr> 
							<tr>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefExptCom" value="{!reqDefBean.dateExpected}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefexpectedcompletion}"/>
								</td>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefServiceCoordinator" value="{!reqDefBean.serviceCoordinator}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__assignedto}"/>
								</td>
							</tr>
							<tr>
								<td height="2" colspan="2"></td>
							</tr> 
							<tr>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="reqDefPhone" value="{!reqDefBean.phone}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__phone}"/>
								</td>
								<td class="clsPanelInputCheckboxTDSA">
									<apex:inputCheckbox title="" id="Approvals" value="{!reqDefBean.approvals}"/> 
									<apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__approvals}"/>
								</td>
							</tr>
						
						</table>
						</td>
					</tr>
                    <tr>
                        <td height="11" ></td>
                    </tr>
                    
                      <tr>
                            <td class="clsBoldInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__SRM_RequestDefinition__c.fields.BMCServiceDesk__ProvideInformation__c.label}"/></td>
                        </tr>
                    <tr>
                        <td><apex:outputLabel value="{!$Label.bmcservicedesk__provideinstruction}"/></td>
                    </tr>
                    <tr>
                        <td height="6" ></td>
                    </tr>
                    <tr>
                        <td class="clsPanelInputCheckboxTDSA">
                            <apex:inputCheckbox title="" id="reqDefDateReq" value="{!reqDefBean.dateRequired}"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefdatereq}"/>
                        </td>
                    </tr>
                    <tr>
                        <td height="6" ></td>
                    </tr>
                    <tr>
                        <td class="clsPanelInputCheckboxTDSA">
                            <apex:inputCheckbox title="" id="reqDefQuantity" value="{!reqDefBean.quantity}"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefquantity}"/>
                        </td>
                    </tr>
					<tr>
                        <td height="6" ></td>
                    </tr>
                     <tr>
                        <td class="clsPanelInputCheckboxTDSA">
                            <apex:inputCheckbox title="" id="reqDefAttachment" value="{!reqDefBean.attachment}" onclick="enableRequiredAttachment();"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__attachments}" />
                        </td>
                    </tr>
                    <tr>
                        <td height="6" ></td>
                    </tr>
                    <tr>
                     <td class="clsPanelInputCheckboxTDSA">
                            <apex:inputCheckbox title="" id="reqDefAttachmentRequired"  style="margin-left: 20px;" value="{!reqDefBean.attachmentRequired}"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__requiredattachmentchkbox}"/>
                        </td>
                    </tr>
					<tr>
                        <td height="11" ></td>
                    </tr>
                    
                    <tr>
                        <td class="clsBoldInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__reqdefpricequantityforstafflabel}"/></td>
                    </tr>
                    <tr>
                        <td height="6" ></td>
                    </tr>
                    <tr>
                        <td class="clsPanelInputCheckboxTDSA">
                            <apex:inputCheckbox title="" id="reqDefpriceQuantityForStaff" value="{!reqDefBean.priceQuantityForStaff}"/> 
                            <apex:outputLabel styleClass="clsPanelCheckBoxLabel" value="{!$Label.bmcservicedesk__reqdefpricequantityforstaff}"/>
                        </td>
                    </tr>
                    <tr>
                        <td height="11" ></td> 
                    </tr>
        </table>    
            <script>
                  var inactiveValue = '{!reqDefBean.isInActive}';
				  var prefixPromptValue = {!reqDefBean.reqDefObj.BMCServiceDesk__Prefix_Prompt_to_user_input__c};
           </script>      
                </apex:outputPanel>
                
                
                
                </div>
            </tr>
        </table>

        </div>
        
        <apex:outputPanel id="apexMessageErrorPanel" >
         <div id="apexMessageErrorPanelDiv" style="display:none;">
            <apex:messages />
        </div>
     </apex:outputPanel>
     
     <!--  
         Input hidden, contains changed/rearranged ordered string for request inputs
     -->
    <apex:inputHidden value="{!reqDefBean.reqInputOrderStr}" id="reqInputOrder"/>
    
    <apex:actionRegion >
        <apex:actionFunction name="addProcessTemplateAction" action="{!addTemplate}" rerender="processTemplateStore, mappingDataPanel,validationComponent" oncomplete="setProcessData();showError();">
            <apex:param name="templateId" value="" assignTo="{!reqDefBean.newTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeProcessAction" action="{!removeProcess}" rerender="processTemplateStore, mappingDataPanel, inputMappingStore, validationComponent" oncomplete="setProcessData();setInputMappingData();showError();waitMsg.hide();">
            <apex:param name="templateId" value="" assignTo="{!reqDefBean.delTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeRequestInputAction" action="{!removeRequestInput}" rerender="requestInputStore, mappingDataPanel, inputMappingStore, validationComponent" oncomplete="setInputData();setInputMappingData();showError();addInputBtnHandler();waitMsg.hide();">
            <apex:param name="reqInputId" value="" assignTo="{!reqDefBean.requestInputId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="updateInputDataAction" action="{!resetInputData}" rerender="requestInputStore, mappingDataPanel, validationComponent" oncomplete="setInputData();showError();"/>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="addMappingAction" action="{!addInputMapping}" rerender="inputMappingStore, processVarStore, validationComponent" oncomplete="setInputMappingData();setProcessVarData();showError();waitMsg.hide();">
            <apex:param name="mapProcessId" value="" assignTo="{!reqDefBean.mapProcessId}"/>
            <apex:param name="mapReqInputIds" value="" assignTo="{!reqDefBean.mapReqInputIds}"/>
            <apex:param name="mapProcessVar" value="" assignTo="{!reqDefBean.mapProcessVarId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="removeInputMappingAction" action="{!removeInputMapping}"  rerender="inputMappingStore, processVarStore, validationComponent" oncomplete="setInputMappingData();setProcessVarData();showError();waitMsg.hide();">
            <apex:param name="mappingIndex" value="" assignTo="{!reqDefBean.mappingIndex}"/>
        </apex:actionFunction>
    </apex:actionRegion>
    <apex:actionRegion >
        <apex:actionFunction name="updateProcessVarAction" action="{!resetProcessVarData}" rerender="processVarStore" oncomplete="setProcessVarData();setInputMappingData();waitMsg.hide();">
            <apex:param name="processVarTemplateId" value="" assignTo="{!reqDefBean.processVarTemplateId}"/>
        </apex:actionFunction>
    </apex:actionRegion>
	<apex:actionFunction name="deleteFulfillmentCriteria" action="{!deleteFulfillmentCriteria}" rerender="afterSavePanel,criteriaTextDiv" oncomplete="waitMsg.hide();">
		<apex:param assignTo="{!reqDefBean.reqDefObj.FKLookupFilter__c}" name="LKfilterId" value="" />
    </apex:actionFunction>
    </apex:form>
    <apex:outputPanel id="afterSavePanel">
        <script>
			var recordID='{!reqDefBean.reqDefObj.Id}';
      errormsg = '{!JSENCODE(reqDefBean.messageString)}';       
      targetInDays= '{!reqDefbean.targetInDays}';
      targetInHours= '{!reqDefbean.targetInHours}';
  	  var directLink = '{!JSENCODE(reqDefBean.directLink)}';
  
      newTitle = '{!JSINHTMLENCODE(reqDefBean.reqDefObj.serviceRequestTitle__c)}';      
      reDefId= '{!reqDefBean.reqDefObj.id}';
	  LKfilterId= '{!reqDefBean.reqDefObj.FKLookupFilter__c}';
	  var TextLink = document.getElementById('PopupLink');
	  if(LKfilterId == null || LKfilterId == ''){
		if(typeof(TextLink) != 'undefined' && typeof(TextLink.innerText) != 'undefined')
			TextLink.innerText = labelNew;
		else
			TextLink.textContent = labelNew;
		document.getElementById('DeleteLink').style.display = 'none';
		document.getElementById('CriteriaText').style.width = '87.5%';		
	  }
	  else{
		if(typeof(TextLink) != 'undefined' && typeof(TextLink.innerText) != 'undefined')
			TextLink.innerText = labelEdit;
		else
			TextLink.textContent = labelEdit;
		document.getElementById('DeleteLink').style.display = 'inline';
		document.getElementById('DeleteLink').style.paddingLeft = '5px';
		document.getElementById('CriteriaText').style.width = '83.5%';
	  }	
		
        function callCopyPage(){
            window.parent.addTab("RequestDefPage?copyId=" + reDefId,reqDefWindowHeader,reqDefWindowHeader);
        }
      prevProcessTemplateId = '{!reqDefBean.prevProcessTemplateId}';
      deletedProcessId = '{!deletedId}';
      
      function handleSave(){
            descPopUpWindow = null;
            window.parent.handleSave(getWID(), reDefId);
      }
      if(directLink!=null && directLink!=undefined && directLink!=''){
	  	document.getElementById('ReqDef_DirectLinkTR').style.display='table-row';
      }
      else{
      	document.getElementById('ReqDef_DirectLinkTR').style.display='none';
      }
      </script>

     </apex:outputPanel>
     
     <apex:outputPanel id="EntitlementScript">
        <script>
         	entitlementOptionSelected = '{!JSENCODE(reqDefBean.entiltementOption)}';
         
            permissionsetRightStoreData = [{!reqDefBean.selectedPermissionsets}];
            permissionsetLeftStoreData = [{!reqDefBean.unSelectedPermissionsets}];
            
            profileRightStoreData = [{!reqDefBean.selectedProfiles}];
            profileLeftStoreData = [{!reqDefBean.unselectedProfiles}];
            
            accRightStoreData = [{!reqDefBean.selectedAccEnt}];
            accLeftStoreData = [{!reqDefBean.unSelectedAccounts}];            
            
        function callToggleAccountSelector() {
            toggleAccountSelector('{!reqDefBean.reqDefObj.allAccounts__c}');        
        }
        function callEntitlementSelector() {
            entitlementSelector('{!JSENCODE(reqDefBean.entiltementOption)}');
        }
        function getPreFirstBtn(){
            var preFirstBtn = !{!IF(paginator.hasPrevious,'true','false')};                    
            return preFirstBtn;
        }
        function getNextLastBtn(){
            var nextLastBtn = !{!IF(paginator.hasNext,'true','false')};          
            return nextLastBtn;
        }
        </script>
     </apex:outputPanel>
     
     <script>
        var endtime1 = '{!endtime}';
        var etestdate = new Date();
        var etesttime = etestdate.getTime();
        
        servertime1 = (endtime1 - stime);
        
        data +=servertime1;
        data += '<br>';
        
            //time to calculate page rendertime 
            var pageloaddate = new Date();
            var renderingstartitme = pageloaddate.getTime();
     </script>
     
     <script>
            var dirtyFlag;
            var disabled = false; 
			var fulfillmentBtn = document.getElementById('ReqDef_Fulfillment');
			var inputbtn = document.getElementById('ReqDef_Input');
           if(reDefId == ''){
                 disabled = true ;
                 fulfillmentBtn.disabled = true;
                 fulfillmentBtn.style.color='#808080';
                 fulfillmentBtn.style.cursor='default';
                 inputbtn.disabled = true;
                 inputbtn.style.color='#808080';
                 inputbtn.style.cursor='default';
                 document.getElementById('{!$Component.ReqDefForm.ReqDef_Title}').focus();
           }
           function enablebtn(){
              if(errormsg == labelSavedSuccessfully && disabled == true){
                  fulfillmentBtn.disabled = false ;
                  fulfillmentBtn.style.color = '#004376';
                  fulfillmentBtn.style.cursor='pointer';
                  inputbtn.disabled = false ;
                  inputbtn.style.color = '#004376';
                  inputbtn.style.cursor='pointer';
				  buttonHandler('/apex/FulfillmentInputDetailPage?requestId='+reDefId+'&isInputCreateable='+isInputCreateable);
              }
              Ext.getCmp('saveId').setDisabled(false);
			  Ext.getCmp('saveId').setIconClass('bmcSave'); 
			  waitMsg.hide();
           }
           checkPermissions();
           function getExecOrderEle(){
           	return document.getElementById('{!$Component.ReqDefForm.RequestDefinition__c_id_Set_Execution_Order__c}');
           }		   
           var description_RichText = document.getElementById('{!$Component.ReqDefForm.ReqDef_Description_RichText}').value;;           
           function setDescriptionFields(){              
              document.getElementById('{!$Component.ReqDefForm.ReqDef_Description_RichText}').value = description_RichText ;
           }
          var SRTemplateId = '{!$Component.ReqDefForm.SYSTemplate__c_id_id}';
          var SRTemplatename = '{!$Component.ReqDefForm.SYSTemplate__c_id_name}';
          var INTemplateId = '{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}';
          var INTemplatename = '{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}';
          var Templatepage = '{!$Page.Templatepage}';
		  var serviceName='{!JSENCODE(reqDefBean.businessServiceName)}';
          var refVal='{!JSENCODE(reqDefBean.reqDefObj.FKBusinessService__c)}';
          var CloseWindowLabel = '{!JSENCODE($Label.CloseWindow)}';
          var closeWindowLabelMsg = '{!JSENCODE($Label.CloseWindowLabel)}';
          var serviceValue= document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c}').value;
          var serviceOfferingValue = document.getElementById('{!$Component.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}').value;
          var serviceOfferingName = '{!JSENCODE(reqDefBean.ServiceOfferingName)}';
		  
		  function onServiceChange(){ 
                 
              var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}'); 
              if(tempEl!=null&&serviceName!=tempEl.value){ 
                   clearOffering(); 
                   serviceName=tempEl.value; 
              }                   
          } 

		  function clearOffering(){
              document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}').value='';
          }
		  
		  function setServiceName(){
				var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
				if(tempEl!=null&&serviceName!=tempEl.value)
					serviceName=tempEl.value;                          
          }    
		  
		  function setSubServiceId(){
			var tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c}');
			if(tempEl!=null&&serviceName!=tempEl.value)
				serviceName=tempEl.value;
			tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_id}');
			if(tempEl!=null&& refVal!=tempEl.value)
				refVal=tempEl.value;
			tempEl=document.getElementById('{!$Component.thePage.ReqDefForm.BMC_BaseElement__c_id_name__c__x_1}');
			if(tempEl!=null&&serviceOfferingName!=tempEl.value)
                serviceOfferingName=tempEl.value; 
		  }	       
        function setDirtyFlag(value)
        {
            dirtyFlag=value;
        }
        function showWarningOnClose()
        {
            popUpWindow.on('beforeclose',function(w)
            {                
                if(!w.pendingClose && dirtyFlag==true)
                {
                    Ext.Msg.show({
                        title:CloseWindowLabel,
                        msg:closeWindowLabelMsg,
                        buttons: Ext.Msg.YESNO,
                        fn:  function(btn){
                            if (btn == 'yes'){
                                w.pendingClose = true;
                                w.close();
                            }
                        },
                        icon: Ext.MessageBox.WARNING
                    });
                    return false; //always return false
                }
            }); 
        }         
        function openCreateNewPopup(popupFor)
        {
            var link;
            var onCompleteFunction;
            var height;
            var width;
            var title;
            if(popupFor=='INC Template')
            {
                height=680;
                width=800;
                title = '{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.IncidentTemplate)}';
                link='TemplatePage?standardLayout=true&id=&columnField=Name&direction=ASC&wid=2&isFromSRD=true&TemplateFor=Incident';
                var INCTemplateName =  document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}').value;
                if(INCTemplateName =='' || INCTemplateName ==null)
                    onCompleteFunction=updatetIncidenttemplatevalues; 
                else
                    onCompleteFunction=null;    
            }
            if(popupFor=='SR Template')
            {
                var incidenttemplId= document.getElementById(INTemplateId).value;
                var incidenttemplName= document.getElementById(INTemplatename).value;
				link='TemplatePage?standardLayout=true&id=&columnField=Name&direction=ASC&wid=2&isFromSRD=true';
				link+='&TemplateFor=rd&incid='+incidenttemplId+'&incname='+encodeURIComponent(incidenttemplName);
				height=550;
				width=700;
				title='{!JSENCODE($Label.Create_New_Request_Defination_Template)}';
				var SRTemplateValue=  document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
				if(SRTemplateValue==null || SRTemplateValue=='')
					onCompleteFunction=updatetSRtemplatevalues;
				else
					onCompleteFunction = null;
			}
            if(popupFor == 'Category')
			{
                link = 'CategoryPage?isFromSRD=true';
                height = 450;
                width = 800;
                title = '{!JSENCODE($Label.Create_New)} {!JSENCODE($Label.AdminCategory)}';
                var categoryName = document.getElementById('{!$Component.ReqDefForm.Category__c_id_name}').value;
                if(categoryName=='' || categoryName==null)
                    onCompleteFunction = openCategoryPage;
                else    
                    onCompleteFunction = null;
            }
            openPopupWithTitle(link,onCompleteFunction,title,height,width);
        }
        var INCValue;
        function getIncValue()
        {
            return document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_name}').value;
        }
        
        function clearSRTemplate()
        {
            document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value='';
            document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_id}').value='';
        }
        function clearAssociatedIdsInc()
        {
            var incTemplateValue= getIncValue();
            if(incTemplateValue=='' || incTemplateValue==null)
            {
                clearSRTemplate();
                document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}').value='';
            }
        }
        function fetchDataForSR(event)
        {
            var SRTemplateValue = document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
            if(SRTemplateValue!= null && SRTemplateValue!='')
                showalldata(event,OncompleteUpdateIncTemplate,escape('(templateFor__c=\'Request Detail\')'));
        }
        function clearAssociatedIdsSR()
        {
            var SRTemplateValue = document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_name}').value;
            if(SRTemplateValue =='' || SRTemplateValue ==null)
            {
                document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id_id}').value='';
            }
        }
                       
        var setLookupCriteriaID;
        function assignLookupCriteriaID(LookupCriteriaID){ 
             setLookupCriteriaID=LookupCriteriaID;
         }
         function onCompleteSetIncident(returnValue)
         {
             var incId=document.getElementById('{!$Component.ReqDefForm.SYSTemplate__c_id__inc_id}').value;
             var originalValueIncTemplate='{!JSENCODE(reqDefBean.IncidentTemplateName)}'; //value stored at server
             if(originalValueIncTemplate!=returnValue) //New Value for Inc Template
                 clearSRTemplate();
             if(returnValue=='' || returnValue==null) 
              {          
             
                  clearAssociatedIdsInc();
              }
         }
     </script>
</apex:page>