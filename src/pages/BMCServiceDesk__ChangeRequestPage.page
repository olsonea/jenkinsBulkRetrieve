<apex:page cache="true" controller="BMCServiceDesk.ChangeRequestController" sidebar="false" showHeader="false"  standardStylesheets="false" contentType="{!changeBean.contentTypeForIE}" extensions="BMCServiceDesk.JSRemoteActions">
<c:CommonIncludes />
<apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/JSTemplate.js"/>
<script>
    windowloaddate = new Date();
    networklatencystart = windowloaddate.getTime();
    window.parent.needsRefresh = false;
  </script> 
 <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/ChangeRequest.js"/> 
  <link rel="stylesheet" type="text/css" href="{!$Resource.SDEFStyles}/ChangeRequestPage.css" />
  <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/ChangeAutocomplete.js"/> 
  <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFCommonJS}/CustomFieldsFormGeneral.js"/>
  <apex:includeScript value="{!$Resource.BMCServiceDesk__SDEFExtJS31}/src/locale/ext-lang-{!userlocale}.js" />
<c:UserContextComponent />
<apex:outputPanel >
    <script>
	    function hideWaitImg(){
    	if(waitMsg != null && typeof(waitMsg) != 'undefined' && waitMsg !='')
    		waitMsg.hide();
    } 
    	function refreshRelatedPortlets(){
                if(typeof(window.parent.parent.refreshActionItemsPortlet) == 'function')
                		window.parent.parent.refreshActionItemsPortlet('Action Items','CR');
                if((getIsChildTempExist() == 'true' || getIsChildTempExist() == true)&& typeof(window.parent.parent.refreshActionItemsPortlet) == 'function'){
                		window.parent.parent.refreshActionItemsPortlet('Action Items','TASK');
                }
      }
      var changeId;   
      var isChangeCreatable;
      var isChangeDeletable;
      var isChangeUpdateable;  
      var doNotCalUrgency = false;;
      var closedStageName = '{!JSENCODE(changebean.statusName)}'; 
    </script>
    <script>
    var wid = '{!JSENCODE($CurrentPage.parameters.wid)}',
        wid2 = '{!JSENCODE($CurrentPage.parameters.wid)}',
        ClosedStage = '{!JSENCODE($Label.ClosedStage)}',
        labelSavedSuccessfully = '{!JSENCODE($Label.SavedSuccessfully)}',
        labelPM_netwokLatency = '{!JSENCODE($Label.PM_netwokLatency)}',
        labelCIExpCIExplorer = '{!JSENCODE($Label.CIExpCIExplorer)}',
        labelConfigurationItemsExplorer = '{!JSENCODE($Label.ConfigurationItemsExplorer)}',
        labelValidDateTime = '{!JSENCODE($Label.ValidDateTime)}',
        labelDelete = '{!JSENCODE($Label.Delete)}',
        labelDeleteTaskPage = '{!JSENCODE($Label.DeleteConfirmMessage)}',
        labelNew = '{!JSENCODE($Label.New)}',
        labelSave = '{!JSENCODE($Label.Save)}',
		labelOK = '{!JSENCODE($Label.OK)}',
        labelCopy = '{!JSENCODE($Label.Copy)}',
        labelReset = '{!JSENCODE($Label.Refresh)}',
        labelAssignTo = '{!JSENCODE($Label.AssignTo)}',
        labelIncidentsStaff = '{!JSENCODE($Label.IncidentsStaff)}',
        labelIncidentsSuggestedStaff = '{!JSENCODE($Label.IncidentsSuggestedStaff)}',
        labelIncidentMyself = '{!JSENCODE($Label.IncidentMyself)}',
        labelIncidentMemberofProfName = '{!JSENCODE($Label.IncidentMemberof)} {!userProfileName}',
        labelQueue = '{!JSENCODE($Label.Queue)}',
        labelActions = '{!JSENCODE($Label.Actions)}',
        labelIncidentClose = '{!JSENCODE($Label.Close)}',
        labelIncidentQuickClose = '{!JSENCODE($Label.IncidentQuickClose)}',
        labelReopenChange = '{!JSENCODE($Label.ReopenChange)}',
        labelTemplate = '{!JSENCODE($Label.Template)}',
        labelLaunchCIExplorer = '{!JSENCODE($Label.LaunchCIExplorer)}',
		labelEmailMessage = '{!JSENCODE($Label.Email)}',
        labelTooltipChangeInactive = '{!JSENCODE($ObjectType.Change_Request__c.fields.Inactive__c.label)}',
        labelPreviousRecord = '{!JSENCODE($Label.PreviousRecord)}',
        labelNextRecord = '{!JSENCODE($Label.NextRecord)}',
        labelDragResizeClickCollapse = '{!JSENCODE($Label.DragResizeClickCollapse)}',
        labelClickToExpand = '{!JSENCODE($Label.ClickToExpand)}',
        labelMsgNoAccessPerm = '{!JSENCODE($Label.MsgNoAccessPerm)}',
        labelPM_PageLoad = '{!JSENCODE($Label.PM_PageLoad)}',
        labelPM_netwokLatency = '{!JSENCODE($Label.PM_netwokLatency)}',
        labelSelectFrom = '{!JSENCODE($Label.SelectFrom)}', 
		labelCancel = '{!JSENCODE($Label.Cancel)}',
	    labelServiceTargets = '{!JSENCODE($Label.SLM_ServiceTargets)}',
		ChangeRequestHeader = '{!JSENCODE($ObjectType.Change_Request__c.label)}',
		labelChangeMgmtProcess = '{!JSENCODE($Label.ChangeMgmtProcess)}',
		ChangeProcess= '{!JSENCODE($Label.ChangeProcess)}',
		AlignabilityProcessModel = '{!JSENCODE($Label.AlignabilityProcessModel)}',
		labelResponded = '{!JSENCODE($Label.IncidentResponded)}', 
		labelRolloutPlan='{!JSENCODE($ObjectType.Change_Request__c.fields.Roll_Out_Plan__c.label)}',
        labelBackoutPlan='{!JSENCODE($ObjectType.Change_Request__c.fields.Back_Out_Plan__c.label)}',
        labelReasonForChange='{!JSENCODE($ObjectType.Change_Request__c.fields.Reason_for_Change__c.label)}',
        labelChangeDescription='{!JSENCODE($ObjectType.Change_Request__c.fields.Change_Description__c.label)}',
        labelReviewComments='{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Review_Comments__c.label}';
        labelInactive ='{!JSENCODE($ObjectType.Change_Request__c.fields.Inactive__c.label)}',
        labelMsgPageHeader = '{!JSENCODE($Label.ComposeEmailChangePageHeader)}',
        rolloutComponent = '{!$Component.changeForm.change_Roll_Out_Plan__c}',
        backoutComponent = '{!$Component.changeForm.change_Back_Out_Plan__c}',
        changeDescriptionComponent = '{!$Component.changeForm.change_Change_Description__c}',
        resonforChangeComponent ='{!$Component.changeForm.change_Reason_for_Change__c}',
        reviewCommentsComponent = '{!$Component.changeForm.change_Review_Comments__c}',
        profileId = '{!$Profile.Id}',
        DeletedRecord = '{!JSENCODE($Label.DeleteConfirmMessage)}',
        Information = '{!JSENCODE($Label.Information)}',
        changeFormComponent = '{!$Component.changeForm}',
        cookieName= 'ConfigureSI'+'{!changeBean.currentUserId}',
        labelRecordDeleted ='{!JSENCODE($Label.DeletedRecord)}', 
        ChangeChatterFeed = '{!JSENCODE($Label.ChangeChatterFeed)}',    
        cookieValue = Ext.util.Cookies.get(cookieName),
        modName = '{!JSENCODE($CurrentPage.parameters.moduleName)}',
        parentWid = '{!JSENCODE($CurrentPage.parameters.parentWid)}',
        islookup = '{!JSENCODE($CurrentPage.parameters.islookup)}',
        OverwriteWarning='{!JSENCODE($Label.OverwriteWarning)}',
        replaceUnsaved = '{!JSENCODE($Label.replaceUnsaved)}',
        wid = '{!JSENCODE($CurrentPage.parameters.wid)}',
        labelIncidentPlural = "{!JSENCODE($ObjectType.Incident__c.LabelPlural)}",
        labelChangeQueue  = "{!JSENCODE($Label.Queue)}"; 
		pageUrl= document.location.href.split('apex/');
		var txtSize;
		isErrorMsg=false;
Ext.ns("ChangePageComp");
         ChangePageComp.ComponentVars = {
            IsPriorityChanged: '{!$Component.changeForm.pbarId.changedetail.Priority__c__isPriorityChanged}',
            DueDateCalculationOption: '{!$Component.changeForm.pbarId.changedetail.dueDateCalculationOption}',
            StatusId: '{!$Component.changeForm.pbarId.changedetail.Status__c_id_name}',
            ImpactIDName: '{!$Component.changeForm.pbarId.changedetail.Impact__c_id_name}',
            UrgencyIDName: '{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_name}',
            changeForm: '{!$Component.changeForm}',
            UserLastName: '{!$Component.changeForm.User_id_lastname}',
            PerformancePanel: '{!$Component.changeForm.pbarId.PerformancepanelBar.PerformancePanel}',
            TestPanelID: '{!$Component.changeForm.testpanelId}',
            BaseElementIDName: '{!$Component.changeForm.pbarId.CIDetail.BMC_BaseElement__c_id_name__c}',
            CIExpButton: '{!$Component.changeForm.pbarId.CIDetail.CIExpBut}',
            CategoryIDName: '{!$Component.changeForm.Category__c_id_name}',
            UserID: '{!$Component.changeForm.User_id_id}',
            UserName: '{!$Component.changeForm.User_id_username}',
            CategoryID: '{!$Component.changeForm.Category__c_id_id}',
            CategoryFKUrgency: '{!$Component.changeForm.Category__c_id_fkurgency__c}',
            UrgencyIDName: '{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_name}',
            UrgencyID: '{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_id}',
            ImpactID: '{!$Component.changeForm.pbarId.changedetail.Impact__c_id_id}',
            PriorityID: '{!$Component.changeForm.pbarId.changedetail.varFKPriority}',
            PriorityName: '{!$Component.changeForm.pbarId.changedetail.Priority__c_id_name}',    
            BroadcastIDName: '{!$Component.changeForm.pbarId.broadcastDetails.Broadcasts__c_id_name}',
            PBarItemIDCD: '{!$Component.pbarId.pbarItemIdCD}',
            clientFKUrgency: '{!$Component.changeForm.User_id_fkurgency__c}',
			ChatterdAccordionPanelId: '{!$Component.changeForm.pbarId.ChangeChatterFeed}'
         }
Ext.ns("AddNoteComp");
			AddNoteComp.ComponentVars={
					Notes:'{!$Component.changeForm.ChangeNotes}',
					Duration: '{!$Component.changeForm.ChangeRequestDuration}'
			}
Ext.ns("AddNote");
			AddNote.Labels ={
				DurationError:'{!JSENCODE($Label.DurationError)}',
				Note: '{!JSENCODE($ObjectType.Change_History__c.fields.Note__c.label)}',
				TextAreaOverflow:'{!JSENCODE($Label.TextAreaOverflow)}'
			}

var CustomFieldCorrectValueErrorMsg = '{!JSENCODE($Label.CorrectValueErrorMsg)}';
var CustomFieldInvalidEmail = '{!JSENCODE($Label.InvalidEmail)}';
var CustomFieldCMDBDateError = '{!JSENCODE($Label.CMDBDateError)}';
var CustomFieldrequiredFieldMsg = '{!JSENCODE($Label.requiredAllFieldBRActionPage)}';
var orgNamespace = '{!orgNamespace}';
    </script>
    <script>
 var activeTextAreaId=changeDescriptionComponent,
     activeBtnTitle=labelChangeDescription;
     var txtSize;
     var changeState,
     changeRequestId, changeRequestName='' ;
	
    var data = '';
  	data += '{!JSENCODE($Label.PM_servertime)}';
  	function isRecordDeleted(){
    	return {!isRecDeleted};
    }
 </script>
</apex:outputPanel>
<apex:outputpanel id="addNotePanel">
 <script>
  
    function renderAddNoteAfterClose(){
        	 var elem = document.getElementById('{!$Component.changeForm.ChangeNotes}');
        	 var elemduration = document.getElementById('{!$Component.changeForm.ChangeRequestDuration}');
			 renderAddNoteAfterClose_JS(elem,elemduration);
        }
   function renderSIComponent(){
     	cookieValue = Ext.util.Cookies.get(cookieName);
     	if(cookieValue == true || cookieValue =='true')
     		SIComp('/apex/SIContainerPage?oid='+getChangeId() +'&otype=Change_Request__c&wid='+wid+'&stateofIncident='+getChangeCloseState()+ '&isChangeCreatable='+getIsChangeCreatable()+'&isInactive='+isInactive);
     	else     
     		removeSI('/apex/SIContainerPage?oid='+getChangeId()+'&otype=Change_Request__c&wid='+wid+'&stateofIncident='+getChangeCloseState()+ '&isChangeCreatable='+getIsChangeCreatable()+'&isInactive='+isInactive);
     
     }
        
        function renderAddNoteButton(){
        	var elem = document.getElementById('{!$Component.changeForm.ChangeNotes}');
        	var elemduration = document.getElementById('{!$Component.changeForm.ChangeRequestDuration}');
            renderAddNoteButton_JS(elem,elemduration,changeState, changeRequestId);
	    }   
        function renderChangeNote(){
         renderNote_JS();   
	   }	
       function disableAddNote() {
           var changeNote = document.getElementById('{!$Component.changeForm.ChangeNotes}').value;
           var changeDuration = document.getElementById('{!$Component.changeForm.ChangeRequestDuration}').value;
		   disableAddNote_JS(changeNote,changeDuration);
       }
 
       function validateDuration(){
           var changeDurationElem = document.getElementById('{!$Component.changeForm.ChangeRequestDuration}');
           validateDuration_JS(changeDurationElem);
       }
	  function afterResetSI(){
        	var modName = getModName();  
        	var parentWid = getParentWid();
        	if(modName != null && modName != '' && typeof(modName) != 'undefined' && parentWid != null && parentWid != '' && typeof(parentWid) != 'undefined' && (errormsg==labelSavedSuccessfully || errormsg == '')){
            	window.parent.parent.refreshSupportingInformation(parentWid,modName);

        	}
     	}
 </script>
</apex:outputpanel>
<script>
 var isAutocomplete = false;
        var selectId=0;
        var selectClientId=0;
        var iKeyCodeEvt;
        // Added for Autocomplete   
        var impactData = window.parent.parent.impactData;  
        var urgencyData = window.parent.parent.urgencyData;
        var categoryData = window.parent.parent.categoryData;
        var list= '[]';
        var catId='{!$Component.changeForm.Category__c_id_name}';
        var impId='{!$Component.changeForm.pbarId.changedetail.Impact__c_id_name}';
        var urgId='{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_name}';
        var selectIdForAutoCom;
        var divIdForAutoCom;
        var fieldForAutoCom;
        var eventFoeAutoCom;
        var clUname='{!$Component.changeForm.User_id_username}';
        var clFname='{!$Component.changeForm.User_id_firstname}';
        var clLname='{!$Component.changeForm.User_id_lastname}';
		var customfieldsdisplay = '{!changeBean.CustomFieldsAccordionDisplay}';
		var isInactive= '{!changeBean.changeReqObj.inactive__c}';
        function getStaffHiddeninput(){
            var staffHiddeninput = '{!$Component.changeForm.staffHiddeninput}';
            return staffHiddeninput;
        }
     	var cilink_record = '{!cilink}';
</script>
<apex:outputPanel id="panelId">
<script>
var taboutFlag=false;
function FetchUrgencyHTTP(){
        var  catId = document.getElementById('{!$Component.changeForm.Category__c_id_id}').value;
        var  clientId = document.getElementById('{!$Component.changeForm.User_id_id}').value;
        var catUrgency = document.getElementById('{!$Component.changeForm.Category__c_id_fkurgency__c}').value;
        var clientUrgency = document.getElementById('{!$Component.changeForm.User_id_fkurgency__c}').value;
        if(callFetchUrgencyHTTPJS(clientId, catId, clientUrgency, catUrgency)){
                FetchUrgencyHTTPJS('{!JSENCODE(changeBean.changeReqObj.id)}', '{!$Component.changeForm.Category__c_id_id}',
                    '{!$Component.changeForm.User_id_id}', '{!$Component.changeForm.pbarId.changedetail.Impact__c_id_id}',
                    null,
                    '{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_name}',
                    '{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_id}',
                    '{!$Component.changeForm.pbarId.changedetail.Priority__c_id_name}',
                    '{!$Component.changeForm.pbarId.changedetail.varFKPriority}',null,
                    '{!$Component.changeForm.priorityNameVal}');
        }   

}
function FetchPriorityHTTP(){
            var impactId = document.getElementById('{!$Component.changeForm.pbarId.changedetail.Impact__c_id_id}').value;
            var urgencyId = document.getElementById('{!$Component.changeForm.pbarId.changedetail.Urgency__c_id_id}').value;
            if(impactId != null && impactId != '' && urgencyId != null && urgencyId != ''){
                FetchPriorityHTTPJS(impactId,
                urgencyId,
                '{!$Component.changeForm.pbarId.changedetail.Priority__c_id_name}',
                '{!$Component.changeForm.pbarId.changedetail.varFKPriority}',null,
                '{!$Component.changeForm.priorityNameVal}');
            }
        }

    function getChangeId(){
            var changeId = '{!changeBean.changeReqObj.Id}';
         
            return changeId;
        }
    function getIsChangeCreatable(){
            var isChangeCreatable = '{!changeBean.isChangeCreatable}';
            return isChangeCreatable;
        }
  function getWID(){
            return '{!JSENCODE($CurrentPage.parameters.wid)}';
        }

 function getModName(){
            return '{!JSENCODE($CurrentPage.parameters.moduleName)}';
        }

        function getParentWid(){
            return '{!JSENCODE($CurrentPage.parameters.parentWid)}';
        }

        function getIsLookUp(){
            return '{!JSENCODE($CurrentPage.parameters.islookup)}';
        }  

        function getIsDirect(){
            return '{!JSENCODE($CurrentPage.parameters.isDirect)}';
        }
   	function getID(){
            return '{!JSENCODE($CurrentPage.parameters.id)}';
        }
     function getIsChangeDeletable(){
            var isChangeDeletable = '{!changeBean.isChangeDeletable}';
            return isChangeDeletable;
        }
      function getisChangeUpdateable(){
            var isChangeUpdateable = '{!changeBean.isChangeUpdateable}';
            return isChangeUpdateable;
        }     
         function getIsCopySaved(){    
       return '{!changeBean.isCopySaved}';
     }
	function getapplyTemp(){
 		setcheckforTemplate = '{!showtemplatecheck}'; 
 		overwrite = '{!overwrite}';
	}
    changeId = getChangeId();
    isChangeCreatable = getIsChangeCreatable();
    isChangeDeletable =getIsChangeDeletable();
    isChangeUpdateable = getisChangeUpdateable();
    var iFrameSrc;
function completeDelete(){
                if(errormsg == '{!JSENCODE($Label.InsufficentDeletePrivilege)}'){
                    showError();
                }else{
                    var modName = "{!JSENCODE($CurrentPage.parameters.moduleName)}";  
                    var parentWid = "{!JSENCODE($CurrentPage.parameters.parentWid)}";
                    if(modName != null && modName != '' && typeof(modName) != 'undefined' && parentWid != null && parentWid != '' && typeof(parentWid) != 'undefined'){
                        window.parent.parent.refreshSupportingInformation(parentWid,modName);                       
                    }else{
                    updateTitle();
                    }
                    closeWindow();
                }
     }
    function getServiceRequestId(){
        return document.getElementById('{!$Component.changeForm.pbarId.changedetail.Incident__c_id_id}').value;
    }
    function getServiceRequestNameEle(){
        return document.getElementById('Incident__c_id_name');
    }
    function getServiceRequestName(){
        return "{!changeBean.requestDetailName}";
    }
    
    objName = "{!JSENCODE(objName)}";
</script>
</apex:outputPanel>
<apex:outputPanel id="repeatId">
		 
		  <script> ownerIdString=''; priorityString=''; </script>
		       <apex:repeat value="{!keyValues}" var="mapkeys"> 
		           <script>
		           		  taboutFlag=true;
		                  keyName='{!mapkeys.key}';
		                  keyValue={!mapkeys.value};
						  
						  if(keyName=='FKUrgency__c'){
		                  	doNotCalUrgency = true;
		                  }
		                  if(keyName=='change_Inactive__c'){
		                      Ext.getCmp('change_inactive__c').setValue(keyValue);
		                  }else if(keyName=='change_OwnerId'){
		                      ownerIdString = keyValue;
		                  }else if(keyName=='FKPriority'){
                    			priorityString = keyValue;                  
                		  }else if(keyName=='FKPriorityName'){
                    			priorityNameString = keyValue;                  
                		  }else{
		                      //alert('keyName> '+keyName+'  keyValue>> '+keyValue);
		                      setChangeTemplVal(keyName,keyValue); 
		                  }
		          </script>
		       </apex:repeat>
		      <script>
		      			//setAssignedToJS(ownerIdString);                 
                      if(priorityString != null && priorityString != '' && priorityString != 'undefined'){
                           document.getElementById(ChangePageComp.ComponentVars.PriorityID).value =  priorityString;
                           document.getElementById(ChangePageComp.ComponentVars.PriorityName).value = priorityNameString;
                      }
		       </script>
		 </apex:outputPanel> 
		 
<apex:outputPanel id="errorId">
  <script>
       errormsg = '{!JSENCODE(changeBean.messageString)}';
       if(errormsg != null && errormsg !='' && errormsg !=labelSavedSuccessfully)
	   isErrorMsg=true;
	  else
        isErrorMsg=false;
    </script>
</apex:outputPanel>
<apex:outputPanel id="afterSavDelCloseReopen">
<script>
        function getIsChildTempExist(){
            var isChildTempExist = '{!changeBean.isChildTempExist}';
            return isChildTempExist;
        }               
</script>
</apex:outputPanel>
<apex:outputPanel id="changeFormPanel">
    <script>
    updateFieldsOnSave('{!changeBean.changeName}');
    changeState = '{!changeBean.changeReqObj.state__c}';
    changeRequestId = '{!changeBean.changeReqObj.id}';
	changeRequestName = '{!JSENCODE(changeBean.changeName)}';
	hasServiceTargets = {!HasServiceTargets};
	if(typeof(ChangeServiceTargetButtonState)!='undefined' && ChangeServiceTargetButtonState!=null) ChangeServiceTargetButtonState();
    </script>
</apex:outputPanel>


<script>
    function getSDFStylesResPath(){
        var resPath = '{!$Resource.SDEFStyles}';
        return resPath;
    }

var assignStaffState ='';
var separator='-';
      function setCatData(id, name, catUrgency) {
            document.getElementById('{!$Component.changeForm.Category__c_id_name}').value = name;
            document.getElementById('{!$Component.changeForm.Category__c_id_id}').value = id;
            document.getElementById('{!$Component.changeForm.Category__c_id_fkurgency__c}').value = catUrgency;
            FetchUrgencyHTTP();
      }
      
	  function getAssignMyselfState(){
         var assignMyselfState = '{!changeBean.assignMyselfState}';
         return assignMyselfState;
      }
      function enableMyself(){
      	Ext.getCmp('assignToMyselfButtonId').setDisabled(false);
      }
      function disableMyself(){
      	Ext.getCmp('assignToMyselfButtonId').setDisabled(true);
      }

</script>
<apex:outputPanel id="changeInactivePanel">
      <script>
      function getChangeInactive(){
          var changeInactive = '{!changeBean.changeReqObj.Inactive__c}';
          return changeInactive;
      }
      function getInactiveDisable(){
      	var disableInactive = "{!JSENCODE($CurrentPage.parameters.isInactive)}"; 
    	return disableInactive;
      }
</script>
      </apex:outputPanel>

<apex:outputPanel id="titlePanel">
	<script>
		isInactive= '{!changeBean.changeReqObj.inactive__c}';
        var wid = '{!JSENCODE($CurrentPage.parameters.wid)}';
		function updateTitle(){
			var newTitle = '#{!changeBean.changeName}';  
                        var StageHTML = '{!changeBean.stageHTML}';
			if(newTitle == '#'){
				newTitle = '{!JSENCODE($ObjectType.Change_Request__c.label)}';
			}

			window.parent.changeTitle(wid,newTitle,newTitle);
                        window.parent.addStageProgression(wid, StageHTML);
           
           var changeState = "{!changeBean.changeReqObj.state__c}";
           if(changeState == 'false'){
				renderAddNoteAfterClose();    
           }             
            
		}
		
		
		function createCustomFieldMap(){
         //Following code is added for defect#63285 as the class attribute gets removed when picklist renders so we are again setting class for the picklist field. 
           document.getElementById('{!$Component.changeForm.pbarId.changedetail.change_Change_Category__c}').className    ='clsInputPickList';
           document.getElementById('{!$Component.changeForm.pbarId.changedetail.change_Change_Type__c}').className ='clsInputPickList';
			createControlMap();
            renderElementsByType();			
		}
		
        function updateInactive(){
          	Ext.getCmp('change_inactive__c').setValue('{!changeBean.changeReqObj.inactive__c}');
		}
          
	</script>
</apex:outputPanel>
    <script>
    customActionJsonString = {!customActionJsonString};
    </script>
<apex:outputPanel id="afterSaveId">
  <script>
		changeRequestId = '{!changeBean.changeReqObj.id}';
		changeRequestName = '{!JSENCODE(changeBean.changeName)}';
		print_url=pageUrl[0]+'{!changeBean.changeReqObj.id}'+'/p';
        print_url_pdf='/apex/PrintObjectDetailPDF?id=' +'{!changeBean.changeReqObj.id}';
		hasServiceTargets = {!HasServiceTargets};
		if(typeof(ChangeServiceTargetButtonState)!='undefined' && ChangeServiceTargetButtonState!=null) ChangeServiceTargetButtonState();

  	   var changeIdCopy = '{!changeBean.changeReqObj.Id}';
	  	function enableCustomAction(){
	        	var instanceId = '{!changeBean.changeReqObj.Id}';
	        	enableCustomActionJS(instanceId);
	        }
  	   
  	   function handleSave(){
               var id = "{!changeBean.changeReqObj.Id}";
             
            window.parent.handleSave(wid, id);
        }
        
    function callCopyPage(){
    	var changePageHeader = '{!JSENCODE($ObjectType.Change_Request__c.label)}';
		window.parent.addTab("ChangeRequestPage?copyId=" + changeIdCopy,changePageHeader,changePageHeader);
    }    
   
  function fieldInfo_out(){

   document.getElementById('fieldInfobtn').src='{!$Resource.SDEFStyles}/SDEFbuttons/icon_field_info.png';
  
  }
               function disableSIMenu(){
                    if(document.getElementById(ChangePageComp.ComponentVars.StatusId).value== 'CLOSED'){
                        window.frames.SIIframeID.disableAll();
                    }
                }

            function closeChangeRequest(){
               var changeId='{!changeBean.changeReqObj.Id}';
                   openPopupWithTitle('CloseChangePage?changeId='+getChangeId()+'&isLookup=true',
                             setCloseChangeRequest, '{!JSENCODE($Label.Close)}'+' '+'{!JSENCODE($Label.Change_Request)}', 390, 600);
             
             }
            function resetSupportingInformation(isSave){
                var v1 = {!changeBean.changeReqObj.State__c};
                var inactive = {!changeBean.changeReqObj.inactive__c}
                var isDisplay = document.getElementById('SIIframeID').style.display;
                if(isDisplay !='none'){
                    if(!v1 || inactive){ 
                            window.frames.SIIframeID.disableAll();
                      }else{
                            window.frames.SIIframeID.enableAll();
                    }
                   //window.frames.SIIframeID.setId('{!changeBean.changeReqObj.Id}',isSave); 
                }  
                
             } 
    
    
         var changeCloseState='{!changeBean.changeReqObj.state__c}';
           
            function getChangeCloseState()
            {
               return changeCloseState;
            }
            function getCloseComments()
            {
            return '{!JSENCODE(changeBean.changeReqObj.Close_Comments__c)}';
            }
            function getChangeId()
            {
              return  '{!JSENCODE(changeBean.changeReqObj.Id)}';
              }
function buttonValidators() {
    changeId=getChangeId();

    if(changeId  != null && changeId!=''){ 
	    Ext.getCmp('printButtonId').setDisabled(false);
		Ext.getCmp('printPdfButtonId').setDisabled(false);
	    var isDisplay = document.getElementById('SIIframeID').style.display;
	    if(cookieValue =='true' && isDisplay =='none' ){
	        SIComp('/apex/SIContainerPage?oid='+changeId +'&otype=Change_Request__c&wid='+wid+'&stateofIncident='+getChangeCloseState()+'&isChangeCreatable='+getIsChangeCreatable()+'&isInactive='+isInactive);
	    }else{
	        if(isDisplay == 'none') {
	            document.getElementById('onDemandSITableId').style.display = 'block';
	            document.getElementById('noSIAvailTD').style.display = 'none';
	            document.getElementById('linkSIAvailTD').style.display = 'block';
	        }
	    }
	    
		if(getChangeCloseState() == 'false'){
			Ext.getCmp('emailId').setDisabled(true);
			Ext.getCmp('closeButtonId').setDisabled(true);
			Ext.getCmp('reopenButtonId').setDisabled(false); 
			Ext.getCmp('saveId').setDisabled(true);
			Ext.getCmp('assignToStaffButtonId').setDisabled(true);
			Ext.getCmp('assignToQueueButtonId').setDisabled(true);
			Ext.getCmp('assignToMemberOfAdminButtonId').setDisabled(true);
			Ext.getCmp('assignToMyselfButtonId').setDisabled(true);
			Ext.getCmp('respondedButtonId').setDisabled(true);		
			Ext.getCmp('templateBtnId').setDisabled(true);
	    }    
	    if(getChangeCloseState() == 'true'){
	    	Ext.getCmp('emailId').setDisabled(false);
			Ext.getCmp('emailId').setIconClass('bmcEmailMessage');
	        Ext.getCmp('closeButtonId').setDisabled(false);
	        Ext.getCmp('reopenButtonId').setDisabled(true); 
	        Ext.getCmp('saveId').setDisabled(false);
	        Ext.getCmp('assignToStaffButtonId').setDisabled(false);
	        Ext.getCmp('assignToQueueButtonId').setDisabled(false);
		 	Ext.getCmp('assignToMemberOfAdminButtonId').setDisabled(false);
		 	Ext.getCmp('respondedButtonId').setDisabled(false);
		 	if(setcheckforTemplate=='true')
		 		Ext.getCmp('templateBtnId').setDisabled(false);
		 	else
		 		Ext.getCmp('templateBtnId').setDisabled(true);
		 		
			 if({!changeBean.assignMyselfState}){
			 	Ext.getCmp('assignToMyselfButtonId').setDisabled(false);
			 }else{
			 	Ext.getCmp('assignToMyselfButtonId').setDisabled(true);
			 }
		}
		isChangeDeletable =getIsChangeDeletable();
		if(isChangeDeletable != null && isChangeDeletable == 'false'){
			Ext.getCmp('deleteId').setDisabled(true);
			Ext.getCmp('deleteId').setIconClass('bmcDeleteDisable');
		}
		isChangeUpdateable = getisChangeUpdateable();
		if(isChangeUpdateable != null && isChangeUpdateable == 'false'){
			Ext.getCmp('saveId').setDisabled(true);
           	Ext.getCmp('closeButtonId').setDisabled(true);
           	Ext.getCmp('reopenButtonId').setDisabled(true);
           	Ext.getCmp('assignToStaffButtonId').setDisabled(true);
           	Ext.getCmp('assignToQueueButtonId').setDisabled(true);
			Ext.getCmp('assignToMemberOfAdminButtonId').setDisabled(true);
			Ext.getCmp('assignToMyselfButtonId').setDisabled(true);
			Ext.getCmp('respondedButtonId').setDisabled(true);
		}
		      
    }
     if(isErrorMsg)
	        Ext.getCmp('saveId').setDisabled(false);
		
                  
}         

iFrameSrc='/apex/SIContainerPage?oid='+changeId+'&otype=Change_Request__c&wid='+wid+'&stateofIncident='+getChangeCloseState()+'&isChangeCreatable='+getIsChangeCreatable()+'&isInactive='+isInactive;        
function menuHandler(){
	if({!changeBean.isChangeCreatable}){
		changeMenuHandler('{!changeBean.assignMyselfState}','{!changeBean.changeReqObj.Id}','{!changeBean.closeState}');
	}
}  
    </script>
</apex:outputPanel>

 <apex:outputPanel >
  
  <apex:form id="changeForm"> 
    <c:ValidationComponent errorMsgList="{!changeBean.messageString}" id="validationComponent"></c:ValidationComponent>
       
        <apex:actionFunction action="{!setSelectedClientNext}" name="setClientNext"  
            rerender="User_id_fkurgency__c,User_id_id,User_id_username,Priority__c_id_name,User_id_firstname,User_id_lastname, Urgency__c_id_name,change_Change_Category__c,change_Change_Type__c,panelId" oncomplete="FetchUrgencyHTTP();DisableCIExpBtn();converdisabletoreadonly(); ">
            <apex:param assignTo="{!savedID}" name="savedID" value=""/>
        </apex:actionFunction> 
         <apex:actionFunction action="{!setSelectedStatusNext}" name="setStatusNext" rerender="Status__c_id_name,Status__c_id_id,change_Change_Category__c,change_Change_Type__c" onComplete="autoAssignToMyself();">
                <apex:param assignTo="{!savedID}" name="savedID" value=""/> 
         </apex:actionFunction> 
         
        <apex:actionFunction action="{!setSelectedImpactNext}" name="openImpactLookup" rerender="Impact__c_id_name,Impact__c_id_id,change_Change_Category__c,change_Change_Type__c,Priority__c_id_name" onComplete="autoAssignToMyself();">
                <apex:param assignTo="{!savedID}" name="savedID" value=""/> 
        </apex:actionFunction> 
        
         <apex:actionFunction action="{!setSelectedUrgencytNext}" name="openUrgencyLookup"  
                rerender="Impact__c_id_id,Urgency__c_id_id,Urgency__c_id_name,change_Change_Category__c,change_Change_Type__c,Priority__c_id_name" oncomplete="converdisabletoreadonly(); ">
                <apex:param assignTo="{!savedID}" name="savedID" value=""/>
         </apex:actionFunction>  
           
    <div id="capsule" class="CapsuleDiv1"> 
                        
    <apex:actionFunction action="{!deleteChangeRequest}" name="deleteChangeRequest" rerender="errorId,validationComponent,afterSavDelCloseReopen" oncomplete="refreshRelatedPortlets();completeDelete();refreshparentList();"/>
    <apex:actionFunction action="{!reset}" name="resetChangeRequest" rerender="changeFormPanel,tablePanel,PanelbarOutputPanel,staffPopupID,CustomFieldsOutputPanel,titlePanel" oncomplete=" resetSupportingInformation(false); updateInactive();updateTitle();renderAddNoteButton();createCustomFieldMap();handleResetChange();handleElemEvent();"/>
    <apex:actionFunction name="save" action="{!save}" reRender="errorId,hideSRandCloseDate,afterSaveId,changeFormPanel,validationComponent,titlePanel,assignedToPanel,detailsPanel,panelId,staffPopupID,staffHiddeninput,Priority__c_id_name,CustomFieldsOutputPanel,closeCommentIconID,changeInactivePanel,afterSavDelCloseReopen, openDateTimeId, ChangeChatterFeedComponent,dataPanel" onComplete="hideWaitImg();enableCustomAction();changeMenuHandler('{!changeBean.assignMyselfState}','{!changeBean.changeReqObj.Id}','{!changeBean.closeState}');refreshRelatedPortlets();handleSave();showError();resetSupportingInformation(true);afterResetSI();renderAddNoteButton();updateTitle();handleElemEvent();buttonValidators();refreshparentList();">
    	<apex:param assignTo="{!changeBean.changeReqObj.Inactive__c}" name="savedName" value=""/>
    </apex:actionFunction>         
    <apex:actionFunction name="assignChangeTOStaff" action="{!assignChangeTOStaff}" reRender="assignedToPanel,change_firstname__c,change_lastname__c,change_profile__c,change_phone__c,change_extension__c,staffPopupID,staffHiddeninput,staff_queue" oncomplete="waitMsg.hide();enableMyself();"> 
         <apex:param assignTo="{!changeBean.savedId}" name="savedName" value=""/>
  	</apex:actionFunction>

    <apex:actionFunction action="{!assignChangeTOMyself}" name="assignTOMyself" reRender="change_firstname__c,change_lastname__c,change_profile__c,change_phone__c,change_extension__c,staffPopupID,staffHiddeninput,staff_queue" oncomplete="waitMsg.hide();disableMyself();"/>
  	<apex:actionFunction action="{!reopenChange}" name="reopenChange" rerender="hideSRandCloseDate,changeFormPanel,afterSavDelCloseReopen,afterSaveId,Status__c_id_name,Status__c_id_id,titlePanel,Closed_Date_Time__id_name,closeCommentIconID,titlePanel" oncomplete="refreshRelatedPortlets();updateTitle();handleElemEvent();resetSupportingInformation(false);buttonValidators();renderAddNoteButton();refreshparentList();"/>
   <apex:actionRegion >
	  	<apex:actionFunction name="saveNote" action="{!saveNote}" rerender="panelId,errorId" oncomplete="afterAddNote();renderChangeNote();enableAddNote();" >
	                <apex:param assignTo="{!changeBean.changeNote}" name="changeNote" value=""/>
		    		<apex:param assignTo="{!changeBean.changeDuration}" name="changeDuration" value=""/>  
		    </apex:actionFunction>
  	</apex:actionRegion>
  	<apex:actionregion >
		<apex:actionFunction name="assignChangeTOQueue" action="{!assignChangeTOQueue}" rerender="assignedToPanel,change_firstname__c,change_lastname__c,change_profile__c,change_phone__c,change_extension__c,staffPopupID,staffHiddeninput,staff_queue" onComplete="waitMsg.hide();enableMyself();"> 
        	<apex:param assignTo="{!changeBean.savedId}" name="savedName" value=""/>
      	</apex:actionFunction>
	</apex:actionregion>
	 <apex:actionRegion >
	    <apex:actionFunction action="{!nextBtnHandler}" name="nextChangeBtnHandler" rerender="hideSRandCloseDate,titlePanel,tablePanel,pbarId,afterSaveId,CustomFieldsOutputPanel,closeCommentIconID,panelId,changeInactivePanel" onComplete="menuHandler();updateTitle();handleResetChange();handleElemEvent();renderSIComponent();createCustomFieldMap();handleSave();buttonValidators();"> 
	        <apex:param assignTo="{!changeBean.tempString}" name="idSetString" value=""/>          
		</apex:actionFunction>
	 </apex:actionRegion>
	  <apex:actionRegion >	
		 <apex:actionFunction action="{!previousBtnHandler}" name="previousChangeBtnHandler" rerender="hideSRandCloseDate,titlePanel,tablePanel,pbarId,afterSaveId, CustomFieldsOutputPanel,closeCommentIconID,panelId,changeInactivePanel" onComplete="menuHandler();updateTitle();handleResetChange();handleElemEvent();renderSIComponent();createCustomFieldMap();handleSave();buttonValidators();"> 
	                        <apex:param assignTo="{!changeBean.tempString}" name="idSetString" value=""/>  
	    </apex:actionFunction>
    </apex:actionRegion> 
    <apex:actionFunction name="fetchChangeTemplates" action="{!fetchChangeTemplates}"  rerender="tablePanel, repeatId, CustomFieldOutputPanel,CustomFieldsOutputPanel, Priority__c_id_name,staffHiddeninput,staffPopupID,change_firstname__c,change_lastname__c,change_profile__c,change_phone__c,change_extension__c,staff_queue,assignedToPanel" onComplete="createCustomFieldMap();renderAddNoteButton();"> 
         <apex:param assignTo="{!changeBean.templateId}" name="savedName" value=""/>
	</apex:actionFunction>
    <apex:actionFunction name="setAssignedTo" action="{!setAssignedTo}" rerender="assignedToPanel,staffHiddeninput,staffPopupID,change_firstname__c,change_lastname__c,change_profile__c,change_phone__c,change_extension__c,staff_queue" > 
         <apex:param assignTo="{!changeBean.savedId}" name="savedName" value=""/>
  	</apex:actionFunction>
    <apex:actionFunction name="setCloseChangeRequest" action="{!setSelectedCloseChangeRequest}" rerender="hideSRandCloseDate,closeCommentsPopupID,Category__c_id_name,fieldInfobtn,afterSaveId,Status__c_id_name,titlePanel,Closed_Date_Time__id_name,closeCommentIconID,afterSavDelCloseReopen,Category__c_id_id" oncomplete="updateTitle();handleElemEvent();resetSupportingInformation(false);buttonValidators();refreshparentList();" >  
                  <apex:param assignTo="{!savedID}" name="selectedClosedByUserId" value=""/>
      </apex:actionFunction>
      <apex:actionFunction action="{!respondedAction}" name="respondedBtnHandler" rerender="respondedId"/>
            
      
        <table cellpadding="0" cellspacing="0" class="clsMainTableSI">
            <tr class="clsRowGreyBg">
                <td >
                    <div id="btnToolbar"  ></div>
                 </td>
            </tr>
             <tr >
                     <td >
                         <apex:outputPanel id="dataPanel">
                            <table  cellpadding="0" cellspacing="0" class="clsTable">  
                                <tr >
                                    <td class="clsTopAlignment75">
                                        <apex:outputPanel id="tablePanel">
                                            <table cellpadding="0" cellspacing="0" class="clsTable">
                                                 <tr>
                                                    <td colspan="3" height="15" style="*height: 10px;"></td>
                                                 </tr>
                                                 <tr>
                                                      <td class="clsInputLabelTD" ><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Initiator_Last_Name__c.label}"/></td>
                                                      <td class="clsInputTextBoxTD">
                                                        <apex:inputText disabled="false" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Initiator_Last_Name__c.InlineHelpText}" value="{!changeBean.clientLastName}" id="User_id_lastname" StyleClass="clsInputTextBox"  tabindex="501" 
                                                                onKeyUp="findClients('sel3','autocompleteClientLNameDiv',this,event)" onblur="disableDiv('autocompleteClientLNameDiv');showDataCommon(event,FetchUrgencyHTTP,escape('IsActive = true'));" />
                                                            <div id='autocompleteClientLNameDiv' class="clsAutocompleteDiv">
                                                                <select id="sel3" class="clsAutocompleteSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteClientLNameDiv');" >
                                                                </select>
                                                            </div>
                                                      </td>
                                                        <td class="lookupIconTD">
                                                        <div class="lookUpIconDiv">
                                                            <input type="button" id="lastnameLookup" onclick="if(!inProgress) {openPopup('SearchPage?popupId=Client&isLookup=true',setClientNext);}" class="lookupIconOn"  tabindex="502" />
                                                        </div>
                                                       </td>
                                                </tr>
                                                 <tr>
                                                      <td class="clsInputLabelTD" ><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Initiator_First_Name__c.label}"/></td>
                                                      <td class="clsInputTextBoxTD">
                                                        <apex:inputText disabled="false" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Initiator_First_Name__c.InlineHelpText}" value="{!changeBean.clientFirstName}"  id="User_id_firstname" StyleClass="clsInputTextBox"  tabindex="503" 
                                                            onKeyUp="findClients('sel4','autocompleteClientFNameDiv',this,event)"  onblur="disableDiv('autocompleteClientFNameDiv');showDataCommon(event,FetchUrgencyHTTP,escape('IsActive = true'));"/>
                                                            <div id='autocompleteClientFNameDiv' class="clsAutocompleteDiv">
                                                                <select id="sel4" class="clsAutocompleteSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteClientFNameDiv');" >
                                                                </select>
                                                            </div>
                                                      </td>
                                                      <td class="lookupIconTD">
                                                        <div class="lookUpIconDiv">
                                                            <input type="button" id="firstnameLookup" onclick="if(!inProgress) {openPopup('SearchPage?popupId=Client&isLookup=true',setClientNext);}" class="lookupIconOn"  tabindex="504"  />
                                                        </div>
                                                       </td>
                                                 </tr>
                                                 <tr>
                                                    <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKInitiator__c.label}" /><span class="clsRequiredBlack">&nbsp;*</span></td>
                                                    
                                                        <td class="clsInputTextBoxTD">
                                                        <apex:inputText title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKInitiator__c.InlineHelpText}" value="{!changeBean.clientName}" styleClass="clsInputTextBox"  id="User_id_username" tabindex="505" 
                                                            onKeyUp="findClients('sel5','autocompleteClientUNameDiv',this,event)"onblur="disableDiv('autocompleteClientUNameDiv'); showDataCommon(event,FetchUrgencyHTTP,escape('IsActive = true'));"/>
                                                            <div id='autocompleteClientUNameDiv' class="clsAutocompleteDiv">
                                                                <select id="sel5" class="clsAutocompleteSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteClientUNameDiv');" >
                                                                </select>
                                                            </div>
                                                        <apex:inputhidden id="User_id_id" value="{!changeBean.fkInitiator}"/><apex:inputhidden id="User_id_fkurgency__c"  value="{!changeBean.clientUrgency}"/>
                                                        </td>
                                                        <td class="lookupIconTD">
                                                        <div class="lookUpIconDiv">
                                                            <input type="button" id="initiatornameLookup" onclick="if(!inProgress) {openPopup('SearchPage?popupId=Client&isLookup=true',setClientNext);}" class="lookupIconOn"  tabindex="506"  />
                                                        </div>
                                                       </td>
                                                 </tr>
                                                 <tr style="{!categoryShowStyle}">
                                                    <td class="clsInputLabelTD" >
                                                        <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKCategory__c.label}"/><apex:outputLabel value=" *" styleClass="clsRequiredBlack" rendered="{!changeBean.categoryRequired}"/>
                                                     </td>
                                          
                                                     <td class="clsInputTextBoxTD">
                                                         <apex:inputText id="Category__c_id_name" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKCategory__c.InlineHelpText}"  value="{!changeBean.fCategoryIdStr}"   styleClass="clsInputTextBox" tabindex="507"
                                                                    onKeyUp="findIt('sel2','autocompleteCategoryDiv',this,event)" 
                                                                    onblur="showDataCommon(event,FetchUrgencyHTTP,escape('inactive__c = false')); disableDiv('autocompleteCategoryDiv'); "/>
                                                         <div id='autocompleteCategoryDiv' class="clsAutocompleteDiv">
                                                            <select id="sel2" class="clsAutocompleteSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteCategoryDiv');" >
                                                            </select>
                                                        </div>
                                                         <apex:inputhidden id="Category__c_id_id" value="{!changeBean.fkCategory}"/><apex:inputhidden id="Category__c_id_fkurgency__c" />
                                                         <apex:inputHidden id="priorityNameVal" value="{!changeBean.priorityName}"/>
                                                         
                                                      </td>
                                                      <td class="lookupIconTD">
                                                         <div class="lookUpIconDiv"><input type="button" id="categoryLookup" class="lookupIconOn"  onClick="if(!inProgress) {openPopup('CategorySearchPage?isLookup=true&isSD=true&showFooterPanel=false',openCategoryLookup);}" tabindex="508"/></div>
                                                      </td>
                                                   </tr>
                                             </table>
                     <table cellpadding="0" cellspacing="0">
                     	<tr>
                     		<td height="10"></td>
                     	</tr>
            	        <tr>
                            <td style="padding-left: 5px"><input type="button" id="changeDescriptionBtn" class="changeBtnCls" title = "{!$ObjectType.Change_Request__c.fields.Change_Description__c.label}" value="{!$ObjectType.Change_Request__c.fields.Change_Description__c.label}" style="font-weight:bold" onclick="displayActiveTextArea(this,32000);" /></td>
                                                        <td><input type="button" id="reasonForChangeBtn" style="width:112px" class="changeBtnCls" title = "{!$ObjectType.Change_Request__c.fields.Reason_for_Change__c.label}" value="{!$ObjectType.Change_Request__c.fields.Reason_for_Change__c.label}" onclick="displayActiveTextArea(this,255);"/></td>
                                                        <td><input type="button"  id="rolloutPlanBtn" class="changeBtnCls" style="width:78px" title = "{!$ObjectType.Change_Request__c.fields.Roll_Out_Plan__c.label}" value="{!$ObjectType.Change_Request__c.fields.Roll_Out_Plan__c.label}" onclick="displayActiveTextArea(this,255);"/></td>
                                                        <td><input type="button" id="backoutPlanBtn" class="changeBtnCls" style="width:85px"  title = "{!$ObjectType.Change_Request__c.fields.Back_Out_Plan__c.label}"  value="{!$ObjectType.Change_Request__c.fields.Back_Out_Plan__c.label}" onclick="displayActiveTextArea(this,255);"/></td>
                                                    </tr>
                                                
                                                </table>   
                     <table cellpadding="0" cellspacing="0" width="100%">
                                               <tr>
                                  <td height="5"></td>
                                  
                                                    </tr>
                                                    <tr >
                            <td style="width: 100%;padding-left: 10px;" class="clsRightPadTDForChange">
                               
														<apex:inputTextarea id="change_Change_Description__c" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Change_Description__c.InlineHelpText}" value="{!changeBean.changeDescription}" styleClass="clsInputTextAreaChange" tabindex="509" style="display:block" />
                                                        <apex:inputTextarea id="change_Roll_Out_Plan__c" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Roll_Out_Plan__c.InlineHelpText}" value="{!changeBean.rolloutPlan}" styleClass="clsInputTextAreaChange" tabindex="509" style="display:none" />
                                                        <apex:inputTextarea id="change_Reason_for_Change__c" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Reason_for_Change__c.InlineHelpText}" value="{!changeBean.reasonforChange}" styleClass="clsInputTextAreaChange" tabindex="509" style="display:none" />
                                                        <apex:inputTextarea id="change_Back_Out_Plan__c" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Back_Out_Plan__c.InlineHelpText}" value="{!changeBean.backoutplan}" styleClass="clsInputTextAreaChange" tabindex="509" style="display:none" />
                           
                                                    </td>
                                                    <td class="lookupIconTD">
                                                        <div class="lookUpIconDiv"><input type="button" class="TextboxPopupIcon" onclick="showTextEditor(activeTextAreaId, activeBtnTitle,txtSize, labelOK, labelCancel);"/></div></td>
                                                 </tr>
                                                 </table>
                                                 <table cellpadding="0" cellspacing="0" class="clsTable">
                          <tr>
                             <td height="5"/>
                           </tr>
                                                   <tr>
                                                    <td class="XcheckBoxTD" style="padding-bottom: 5px;"><apex:inputCheckbox id="change_Approved__c" value="{!changeBean.isApproved}"  title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Approved__c.InlineHelpText}" tabindex="509"/> 
                                                     <label for="approvedFld" class="XcheckBoxLabel">{!$ObjectType.Change_Request__c.fields.Approved__c.label}</label>
                                                	</td>
                           </tr>
                           
                            <apex:outputpanel rendered="{!changeBean.isChangeCreatable}" layout="none" >
                                                   <tr>
                              <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Review_Date__c.label}"/></td>
                                 <td class="clsInputTextBoxTD" colspan="3"><apex:inputField id="ReviewDate" value="{!changeBean.changeReqObj.BMCServiceDesk__Review_Date__c}" styleClass="clsInputTextBox" style="width: 200px;"/></td>                                                 
                                                   </tr>
					                               
 </apex:outputpanel>
                           <apex:outputpanel rendered="{!!changeBean.isChangeCreatable}" layout="none" >
                                                   <tr>
                              <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Review_Date__c.label}"/></td>
                                 <td class="clsReadOnlyTextForPermission" colspan="1"><apex:inputField id="ReviewDate1" value="{!changeBean.changeReqObj.BMCServiceDesk__Review_Date__c}" styleClass="clsInputTextBox" />
                                                      </td>
                                                      <td></td>
                                                      <td></td>
                                                   </tr>
                                                   <tr><td height="5" /></tr>
                                       </apex:outputpanel>
                                                   <tr>
                                                      <td class="clsInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Review_Comments__c.label}" /></td>
                                                      
                                                         <td class="clsInputTextFieldTDRel">
                              
                                                        <apex:inputTextArea disabled="false" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Review_Comments__c.InlineHelpText}" id="change_Review_Comments__c" value="{!changeBean.reviewComments}" styleClass="clsInputTextFieldRel"/> 
                               
                                                    </td>
                                                    <td class="TextboxPopupIconTD">
                                                        <div class="TextboxPopupIconDiv"><input type="button" class="TextboxPopupIcon"  onclick="showTextEditor('{!$Component.changeForm.change_Review_Comments__c}', '{!JSENCODE($ObjectType.Change_Request__c.fields.Review_Comments__c.label)}',255, labelOK, labelCancel);" /></div></td>
                                                      
                                                   </tr>
                                                  </table>
                                                  <table cellpadding="0" cellspacing="0" class="clsTable">
                                                           <tr><td height="13" style="*height: 10px;"/></tr>
                                                    <tr>
                                                      <td style="color:#004376;font: bold 11px Tahoma, MS Sans Serif;padding-left:9px;"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_History__c.fields.BMCServiceDesk__Note__c.label}"/></td>
                                                        
                                                    </tr>
                                                   <tr><td height="5" /></tr>
                                                    <tr>                
                              
                                <td  colspan="2" style="padding-left:13px;" class="clsRightPadTD">
                                    <apex:inputTextarea title="{!$Label.bmcservicedesk__tooltipnote}" value="{!changeBean.changeNote}" id="ChangeNotes" styleClass="clsInputTextAreaChange" style="margin-left:-4px;" tabindex="509" onkeyup="renderAddNoteButton();" />
                                                                </td>
                                <td width="10"/>
                                                            </tr>
                                                            <tr>
                               <td >
                               <div  class="DurationDivCls">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_History__c.fields.BMCServiceDesk__Duration__c.label}" styleClass="clsDurationLabel"/>
                                    <apex:inputText value="{!changeBean.changeDuration}" styleClass="clsDurationTextBox" id="ChangeRequestDuration" style="margin-top:4px;" title="{!$Label.bmcservicedesk__tooltipduration}" tabindex="511" onblur="validateDuration();"/><apex:outputLabel value="{!$Label.bmcservicedesk__hhmm}" styleClass="clsTimeLabel" />
                                 </div>
                                                                </td>
                                <td align="right" >
                                <div class="AddBtnDivCls" style="">
                                    <input type="button" value="{!$Label.Add}" style="width:auto;padding:4px;padding-top:2px;" class="AddNoteButton" id="addNoteBtn" onclick="disableAddNote()" />                                                
                                </div>
                                                                </td> 
                                                            </tr>                                                             
                                                        </table>
                                  </apex:outputPanel>
                                </td> 
                                      
                                       
                              <td class="clsTopAlignment25">
                                    <div class="panelCapsule">
                                        <apex:outputPanel id="PanelbarOutputPanel">
                                            <apex:panelBar headerClass="clsRowBlueBgPanel" switchType="ajax" id="pbarId" >
                                                <apex:panelBarItem label="{!$Label.bmcservicedesk__details}" expanded="true" id="changedetail" headerClass="panelHeader" contentClass="panelContent">
                                                	<div id="AccordionDiv">
                                                    <apex:outputPanel id="detailsPanel">  
                                                        <table cellpadding="0" cellspacing="0" class="clsTable">
                                                            <tr>
                                                                <td height="15"></td>
                                                            </tr> 
                                                            <tr >
                                                                <td class="clsPanelInputLabelTD">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKStatus__c.label}"/>
                                                                </td>
                                                                <td class="clsPanelInputTextboxTD1"> 
                                                                   <apex:inputText id="Status__c_id_name" value="{!changeBean.statusName}"  title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKStatus__c.InlineHelpText}" styleClass="clsPanelInputTextbox" onblur="showDataCommon(event,'',escape('inactive__c = false and appliesToChange__c = true'))" tabindex="511"/>
                                                                   <apex:inputhidden id="Status__c_id_id" value="{!changeBean.fkStatus}" />
                                                                </td>
                                                                <td class="lookupIconPanelTD">
                                                                    <div class="lookUpIconDiv"><input type="button" id="statusLookup" onClick="if(!inProgress) {openPopup('SearchPage?popupId=Status&isLookup=true&filterClause='+escape('inactive__c = false and appliesToChange__c = true'),setStatusNext);}" class="lookupIconOn" tabindex="512"/></div>
                                                                 </td>
                                                                 
                                                            </tr>
                                                        <apex:outputpanel rendered="{!changeBean.isChangeCreatable}" layout="none">
 <tr >
                                                                <td class="clsPanelInputLabelTD">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Change_Type__c.label}"/>
                                                                </td>
                                                                <td class="clsPanelInputTextboxTD1"> 
                                                                   <apex:inputField id="change_Change_Type__c" value="{!changeBean.changeReqObj.BMCServiceDesk__Change_Type__c}" styleClass="clsInputPickList"/>
                                                                </td>
                                                                <td>&nbsp;
                                                                 
                                                                 </td>
                                                            </tr>
                                                              <tr >
                                                                <td class="clsPanelInputLabelTD">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Change_Category__c.label}"/>
                                                                </td>
                                                                <td class="clsPanelInputTextboxTD1"> 
                                                                   <apex:inputField id="change_Change_Category__c" value="{!changeBean.changeReqObj.BMCServiceDesk__Change_Category__c}" styleClass="clsInputPickList"/>
                                                                </td>
                                                                <td>&nbsp;
                                                                 
                                                                 </td>
                                                            </tr>  
                                                        </apex:outputpanel>
                                                        <apex:outputpanel rendered="{!!changeBean.isChangeCreatable}" layout="none">
                                                        <tr >
                                                                <td class="clsPanelInputLabelTD">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Change_Type__c.label}"/>
                                                                </td>
                                                                <td> 
																 <apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                   <apex:inputField id="change_Change_Type__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Change_Type__c}" />
																   </apex:outputpanel>
                                                                </td>
                                                            </tr>
                                                            <tr><td class="TDheight5px"></td></tr>
                                                        <tr >
                                                                <td class="clsPanelInputLabelTD">
                                                                    <apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Change_Category__c.label}"/>
                                                                </td>
                                                                <td> 
																<apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                   <apex:inputField id="change_Change_Category__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Change_Category__c}"  />
																   </apex:outputpanel>
                                                                </td>
                                                            </tr>  
                                                             <tr><td class="TDheight5px"></td></tr>
                                                         </apex:outputpanel>                                                       <tr>
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKImpact__c.label}" /></td>
                                                                <td class="clsPanelInputTextboxTD1" align="right">
                                                                <apex:inputText id="Impact__c_id_name" value="{!changeBean.impactName}" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKImpact__c.InlineHelpText}" styleClass="clsPanelInputTextbox safariAutoComplete" tabindex="514"
                                                                        onKeyUp="findIt('sel','autocompleteImpactDiv',this,event)"  onblur="disableDiv('autocompleteImpactDiv');showDataCommon(event,FetchPriorityHTTP,escape('inactive__c = false'));"/>
                                                                        <apex:inputhidden id="Impact__c_id_id" value="{!changeBean.fkImpact}"/>  
                                                                <div id='autocompleteImpactDiv' class="clsPanelAutocompleteDiv">
                                                                    <select id="sel" class="clsPanelSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteImpactDiv');" >
                                                                    </select>
                                                                </div>
                                                                
                                                                
                                                                </td>
                                                                <td class="lookupIconPanelTD">
                                                                      <div class="lookUpIconDiv"><input class="lookupIconOn" id="impactLookup" type="button" onclick="if(!inProgress) { openPopup('SearchPage?popupId=Impact&isLookup=true&filterClause='+escape('inactive__c = false'),openImpactLookup);}"  tabindex="515"/></div>
                                                                 </td>
                                                            </tr>
                                                            <tr>  
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKUrgency__c.label}" /></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                <apex:inputText id="Urgency__c_id_name"  value="{!changeBean.urgencyName}"  title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKUrgency__c.InlineHelpText}" styleClass="clsPanelInputTextbox safariAutoComplete"  tabindex="516" 
                                                                    onKeyUp="findIt('sel1','autocompleteUrgencyDiv',this,event)" onblur="disableDiv('autocompleteUrgencyDiv');showDataCommon(event,FetchPriorityHTTP,escape('inactive__c = false'),escape('urgencyflag'));"/>
                                                                       <apex:inputhidden id="Urgency__c_id_id" value="{!changeBean.fkUrgency}"/>
                                                                <div id='autocompleteUrgencyDiv' class="clsPanelAutocompleteDiv">
                                                                    <select id="sel1" class="clsPanelSelectOption" multiple="multiple" onmousedown="isAutocomplete = true;" onClick="SelectValue(this,'autocompleteUrgencyDiv');" >
                                                                    </select>
                                                                </div>
                                                                
                                                                </td>
                                                                <td class="lookupIconPanelTD" >
                                                                    <div class="lookUpIconDiv">
                                                                        <input class="lookupIconOn" type="button" id="urgencyLookup" onclick="if(!inProgress) {openPopup('SearchPage?popupId=Urgency&isLookup=true&filterClause='+escape('inactive__c = false'),openUrgencyLookup);}"  onblur="if(!inProgress) { }" tabindex="517"/>
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKPriority__c.label}" /></td>
                                                                <td class="clsPanelInputTextboxTD1"><apex:inputText title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKPriority__c.InlineHelpText}" styleClass="clsPanelInputTextboxReadOnly" value="{!changeBean.priorityName}"
                                                                    id="Priority__c_id_name" onfocus="this.blur();" />
                                                                    <apex:inputhidden value="{!changeBean.fkPriority}" id="varFKPriority"/>
                                                                </td>
                                                            </tr>
                                                           

                                                            <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" ><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Open_Date_Time__c.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1"><apex:inputText id="openDateTimeId" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Open_Date_Time__c.InlineHelpText}" value="{!changeBean.openDateTime}" styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/></td>
                                                            </tr>
                                                             <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" ><apex:outputLabel value="{!JSENCODE($ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Responded_Date__c.label)}"/></td>
                                                                <td class="clsPanelInputTextboxTD1"><apex:inputText id="respondedId" title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Responded_Date__c.InlineHelpText}" value="{!changeBean.respondatedDateTime}" styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/></td>
                                                            </tr>
                                                            <apex:outputpanel rendered="{!changeBean.isChangeCreatable}" layout="none">
                                                            <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" style="white-space: normal"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Scheduled_Start_Date__c.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputField id="Scheduled_Start_Date__c" value="{!changeBean.changeReqObj.BMCServiceDesk__Scheduled_Start_Date__c}" styleClass="clsPanelInputTextbox"/>
                                                                </td>
                                                            </tr>
                                                              <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" style="white-space: normal"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Scheduled_End_Date__c.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputField id="Scheduled_End_Date__c" value="{!changeBean.changeReqObj.BMCServiceDesk__Scheduled_End_Date__c}"  styleClass="clsPanelInputTextbox"/>
                                                                </td>
                                                            </tr>
                                                              <tr >                                                         
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!JSENCODE($ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Actual_Start_Date__c.label)}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputField id="Actual_Start_Date__c" styleClass="clsPanelInputTextbox" value="{!changeBean.changeReqObj.BMCServiceDesk__Actual_Start_Date__c}"  styleClass="clsPanelInputTextbox"/>
                                                                </td>
                                                            </tr>
                                                              <tr>                                                         
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Actual_End_Date__c.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputField id="Actual_End_Date__c" value="{!changeBean.changeReqObj.BMCServiceDesk__Actual_End_Date__c}"  styleClass="clsPanelInputTextbox"/>
                                                                </td>
                                                            </tr>
                                                            </apex:outputpanel>
                                                            
                                                            <!-- 
                                                            If user has readonly permissions
                                                             -->
                                                            <apex:outputpanel rendered="{!!changeBean.isChangeCreatable}" layout="none">
                                                            <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" style="white-space: normal"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Scheduled_Start_Date__c.label}"/></td>
                                                                <td>
																<apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                    <apex:inputField id="Scheduled_Start_Date__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Scheduled_Start_Date__c}" styleClass="clsPanelInputTextbox"/>
																	</apex:outputpanel>
                                                                </td>
                                                            </tr>
                                                             <tr><td height="5"></td></tr>
                                                              <tr >                                                         
                                                                <td class="clsPanelInputLabelTD" style="white-space: normal"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Scheduled_End_Date__c.label}"/></td>
                                                                <td>
																<apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                    <apex:inputField id="Scheduled_End_Date__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Scheduled_End_Date__c}"  styleClass="clsPanelInputTextbox"/>
																	</apex:outputpanel>
                                                                </td>
                                                            </tr>
                                                            <tr><td height="5"></td></tr>
                                                              <tr >                                                         
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!JSENCODE($ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Actual_Start_Date__c.label)}"/></td>
                                                                <td>
																<apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                    <apex:inputField id="Actual_Start_Date__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Actual_Start_Date__c}"  styleClass="clsPanelInputTextbox"/>
																	</apex:outputpanel>
                                                                </td>
                                                            </tr>
                                                            <tr><td height="5"></td></tr>
                                                              <tr >                                                         
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Actual_End_Date__c.label}"/></td>
                                                                <td>
																<apex:outputpanel layout="block" styleClass="clsPanelReadOnlyInputTextbox">
                                                                    <apex:inputField id="Actual_End_Date__c1" value="{!changeBean.changeReqObj.BMCServiceDesk__Actual_End_Date__c}"  styleClass="clsPanelInputTextbox"/>
																	</apex:outputpanel>
                                                                </td>
                                                            </tr>
                                                            <tr><td height="5"></td></tr>
                                                            </apex:outputpanel>
                                                            <tr id="serviceReqEle">
                                                              <td class="clsPanelInputLabelTD" ><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__FKServiceRequest__c.label}"/></td>
                                                              <td class="clsPanelInputTextboxTD1">
                                                              <table class="clsPanelInputTextboxReadOnly clsHyperLinkStyle" cellpadding="0" cellspacing="0"><tr><td>
                                                              	<a id="Incident__c_id_name" onclick="OpenServiceRequest('IncidentPage')" href="#">{!JSENCODE(changeBean.requestDetailName)}</a>
                                                              	<apex:inputhidden id="Incident__c_id_id" value="{!changeBean.changeReqObj.BMCServiceDesk__FKServiceRequest__c}"/>
                                                              	</td></tr></table>
                                                              </td>
                                                            </tr>
                                                            <tr id="closeDateEle">                                                         
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Closed_Date_Time__c.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1"><apex:inputText title="{!$ObjectType.BMCServiceDesk__Change_Request__c.fields.BMCServiceDesk__Closed_Date_Time__c.InlineHelpText}" id="Closed_Date_Time__id_name" value="{!changeBean.closeDate}" styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();" /></td>
                                                                 <td class="fieldInfoTD" >
                                                                 <apex:outputPanel id="closeCommentIconID" >
                                                                 	<button type ="button" id="fieldInfobtn" style="{!IF(changeBean.closeState,'display:block','display:none')}" class="commentsInfoTooltip" onmouseover="showInfoPopup(event,'closeCommentsPopupDiv','closeComments');" onmouseout="fieldInfo_out();"/>
                                                                </apex:outputPanel>
                                                                 </td>
                                                            </tr>
                                                    </table>   
                                                    </apex:outputPanel>
                                                    </div>
                                                  </apex:panelBarItem>
                                                  <apex:panelBarItem label="{!staffAssignmentLabel}" headerClass="panelHeader staffAssignmentPanelHeader" contentClass="panelContent" id="staffAssignmentPanel">
					                              		<script>
					                              			var staffPanelBar = document.getElementById('{!$Component.staffAssignmentPanel}');
					                              			var i=0;
								                			if(staffPanelBar.childNodes.length > 0){
									                 			for(i=0; i<staffPanelBar.childNodes.length;i++){
									                 				if(staffPanelBar.childNodes[i] != null)
									                 					if(staffPanelBar.childNodes[i].className.indexOf('staffAssignmentPanelHeader') > 0){
									                 						staffPanelBar.childNodes[i].title = '{!JSENCODE($Label.StaffAssignmentDetails)}';
									                 					}
									                 			}                               			
								                			}
					                              		</script>
                                                     <apex:outputPanel id="assignedToPanel">
                                   <!-- 5 -->         
                                   <!-- 5 -->          <table cellpadding="0" cellspacing="0" class="clsTable">
                                                            <tr>
                                                                    <td colspan="3" class="viewMoreDtlsBg">
                                                                    <button  type ="button" id="staffInfobtn" Class="bmcUserInfoPopup" onmouseover="showInfoPopup(event,'staffPopupDiv','staff');"/></td>
                                                            </tr>
                                                            
                                                            <tr>
                                                                <td height="15"></td>
                                                            </tr> 
                                                                
                                                             <tr >
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.User.fields.FirstName.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputText title="{!$Label.bmcservicedesk__tooltip_staffassignment_firstname}" value="{!changeBean.firstName}" id="change_firstname__c"   styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/>
                                                                </td>
                                                                 <td class="lookupIconPanelTD">&nbsp;</td>
                                                            </tr>
                                                            <tr >
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.User.fields.LastName.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputText title="{!$Label.bmcservicedesk__tooltip_staffassignment_lastname}" value="{!changeBean.lastName}" id="change_lastname__c"   styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/>
                                                                </td>
                                                                 <td class="lookupIconPanelTD">&nbsp;</td>
                                                            </tr>
                                                            <tr >
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.Profile.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputText title="{!$Label.bmcservicedesk__tooltip_staffassignment_profile}" value="{!changeBean.profile}" id="change_profile__c"   styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/>
                                                                </td>
                                                                 <td class="lookupIconPanelTD">&nbsp;</td>
                                                            </tr>
                                                            <tr >
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.User.fields.Phone.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputText title="{!$Label.bmcservicedesk__tooltip_staffassignment_phone}" value="{!changeBean.phone}" id="change_phone__c"   styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/>
                                                                </td>
                                                                 <td class="lookupIconPanelTD">&nbsp;</td>
                                                            </tr>
                                                            <tr >
                                                                <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$ObjectType.User.fields.Extension.label}"/></td>
                                                                <td class="clsPanelInputTextboxTD1">
                                                                    <apex:inputText title="{!$Label.bmcservicedesk__tooltip_staffassignment_extension}" value="{!changeBean.extension}" id="change_extension__c"   styleClass="clsPanelInputTextboxReadOnly" onfocus="this.blur();"/>
                                                                </td>
                                                                 <td class="lookupIconPanelTD">&nbsp;</td>
                                                            </tr>
                                                            <tr>
                                                                 <td class="clsPanelInputLabelTD"><apex:outputLabel value="{!$Label.bmcservicedesk__queue}" /></td>
                                                                 <td class="clsPanelInputTextboxTD1"><apex:inputText onfocus="this.blur()" title="{!$Label.bmcservicedesk__tooltip_staffassignment_queue}" id="staff_queue" value="{!changeBean.queue}"  styleClass="clsPanelInputTextboxReadOnly"/></td>  
                                                                 <td class="lookupIconPanelTD" align="left">&nbsp;</td>
                                                             </tr>
                                                                                                            
                                                            
                                     <!-- 55 -->        </table>
                                     				   </apex:outputPanel>	
                                                    </apex:panelBarItem>
													<apex:panelBarItem onenter="loadChatterFeeds();" label="{!$Label.bmcservicedesk__changechatterfeed}" rendered="{!IF(ChangeRequestFeed,true,false)}" headerClass="panelHeader" contentClass="panelContent" id="ChangeChatterFeed">
														<table>
															<tr><td height = "10"></td></tr>
														</table>
														<c:RecordFeedComponent id="ChangeChatterFeedComponent" RecordID="{!ChangeID}" MoreFeedsTabTitle="{!$Label.bmcservicedesk__changechatterfeed}" TooltipChatterShare="{!$Label.bmcservicedesk__tooltipchattersharechange}" TooltipComment="{!$Label.bmcservicedesk__tooltipchattercomment}" RecordType="Change Request" ></c:RecordFeedComponent>
                                                    </apex:panelBarItem>
                                   
                                                    <apex:panelBarItem id="CustomFieldspanelBar" label="{!$Label.bmcservicedesk__customfields}" headerClass="panelHeader" contentClass="panelContent">
                                                     <apex:outputPanel id="CustomFieldOutputPanel">	
					                                    <script>                                        
					                                        if(customfieldsdisplay == 'block'){
					                                            if(document.getElementById('{!$Component.CustomFieldspanelBar}')){
					                                                document.getElementById('{!$Component.CustomFieldspanelBar}').style.display = "block";
					                                            }
					                                        }else{
					                                            if(document.getElementById('{!$Component.CustomFieldspanelBar}')){
					                                                document.getElementById('{!$Component.CustomFieldspanelBar}').style.display = "none";
					                                            }
					                                        }
					                                    </script>
					                                    <div id="CustomFieldsOutputPanel"> 
					                                        <div id="changerequestcustomfields" style="padding-top:10px;">
					                                            <c:CustomFieldsLayout FieldNames="{!changeBean.IntermediateAttributeNames}" ColumnSize="1" AttributeInfo="{!changeBean.DispAttrs}"  RenderFlag="true" isRecDeleted="{!isRecDeleted}" />
					                                        </div>    
					                                    </div> 
					                                  </apex:outputPanel>  
                                                    </apex:panelBarItem>
                                               </apex:panelBar>
                                               <apex:outputPanel id="hideSRandCloseDate">
                                               <script>
                                               		hideServiceEle = {!OR(ISBLANK(TRIM(changeBean.requestDetailName)),ISNULL(changeBean.requestDetailName))};
                                               		hideServiceRequestEle();
                                          			hideCloseDate = {!OR(ISBLANK(TRIM(changeBean.closeDate)),ISNULL(changeBean.closeDate))};
                                          			hideCloseDateEle();
                                               </script>    
                                               </apex:outputPanel>
                                        </apex:outputPanel>
                                  		
                                       </div>
                                     </td> 
                                </tr>
                             </table> 
                         </apex:outputPanel>
                         
                      </td>
             </tr>
          </table>
          <div style="display:none;">
                        <apex:outputpanel id="staffPopupID">
                       <div id="staffPopupDiv" >                           
                            <table  cellspacing="0" cellpadding ="0" >
                            <tr>
                                <td ><apex:inputHidden id="staffHiddeninput" value="{!changeBean.userId}" /></td>
                                <td>
                                <table cellspacing="0" cellpadding ="0">
                                        <tr >
                                         <td style=" padding-top:5px; padding-left:4px; " class="clsInputBoldLabelTooltip1">                                        
                                         <div id="userNameforttdivId"></div> 
                                          </td>
                                        </tr>
                                        <tr style="{!IF(changeBean.user.title=='','display:none','')}">
                                       
                                        <td style=" padding-top:1px; padding-bottom: 4px; padding-left:4px;" class="clsInputLabelTooltipTitle1">
                                       
                                        <div id="userTitleforttdivId"></div> 
                                        </td>
                                        </tr>
                                        <tr  style="{!IF(changeBean.user.street=='','display:none','')}">
                                        <td style="padding-left:4px; padding-top:1px;" class="clsInputLabelTooltip1"> 
                                       
                                        <div id="userAddressforttdivId"> {!changeBean.user.street} </div>  
                                       </td>
                                        </tr>
                                        
                                        <tr style=" {!IF(changeBean.user.city =='' && changeBean.user.state =='' && changeBean.user.Postalcode =='','display:none','')}">
                                        <td style="padding-left:4px;" class="clsInputLabelTooltip1">
                                        <div id="userCSZforttdivId"></div></td>
                                                                               </tr>
                                        <tr style="{!IF(changeBean.user.country=='','display:none','')}">
                                        <td style="padding-left:4px;" class="clsInputLabelTooltip1">
                                        <div id="userCountryforttdivId"></div> 
                                        </td>
                                        </tr>                                        
                                        <tr style=" {!IF(changeBean.user.Phone=='','display:none','')}">
                                        <td  style=" padding-top:5px; padding-left:4px;" class="clsInputLabelTooltip1">
                                        <div id="userPhoneforttdivId"></div> 
                                        </td>
                                        </tr>
                                        <tr style=" {!IF(changeBean.user.email=='','display:none','')}">
                                        <td style="padding-bottom: 5px; padding-top:1px; padding-left:4px;" class="clsInputLabelTooltip1">
                                        <div id="userEmailforttdivId"></div>
                                           </td>
                                         </tr>                                                                              
                                </table>
                                </td>
                            </tr>
                           </table>
                        
                        </div>
                        <script>
                        function tooltipforstaff(){
				              var cszstringuser = formCSZString('{!JSENCODE(changeBean.user.city)}','{!JSENCODE(changeBean.user.state)}','{!JSENCODE(changeBean.user.Postalcode)}');
				              tooltipforstaffJS('{!JSENCODE(changeBean.user.Name)}','{!JSENCODE(changeBean.user.title)} ',cszstringuser,'{!JSENCODE(changeBean.user.country)}','{!JSENCODE(changeBean.user.Phone)}','{!JSENCODE(changeBean.user.email)}');                          
				        }
				        </script>
                     </apex:outputpanel>
                             <apex:outputpanel id="closeCommentsPopupID"  >
                             <div id="closeCommentsPopupDiv" >                           
                             <script>
                             function assignTheCommentValue(){
                             	document.getElementById('closeCommentsPopupDivID').innerHTML = '{!JSENCODE(changeBean.closeComments)}';
                             }
                             </script>
                            <table  cellspacing="0" cellpadding ="0" >
                            <tr>
                              
                                         <td style="padding:5px;padding-right:-10px;" class="clsInputLabelTooltip1">
                                         <div id="closeCommentsPopupDivID"> </div>                                        
                                          </td>
                                 
                            </tr>
                           </table>
                        </div>
                           </apex:outputpanel>
     </div>        
                        </div>
      <div id="detailsDivSI">
                      <table  class="onDemandSITableCls" id="onDemandSITableId">
                          <tr>
                             <td id="noSIAvailTD">{!$Label.SIMessageForNewIncident}</td>
                          </tr>  
                          <tr >
                              <td id="linkSIAvailTD">
                                 <table class="SICheckboxLinkInnerTable">
                                    <tr>
                                        <td id="configureSITD">
                                            <input type="checkbox" title="{!$Label.ShowSupportingInformation}" id="configureSIId" onClick="writeCookie();"/>&nbsp;{!$Label.SIMessageForConfiguration}
                                            
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a id="getSIUrl" href="JavaScript:void(0);" onClick="SIComp('/apex/SIContainerPage?oid='+getChangeId()+'&otype=Change_Request__c&wid='+wid+'&stateofIncident='+getChangeCloseState()+ '&isChangeCreatable='+getIsChangeCreatable()+'&isInactive='+isInactive);" >{!$Label.SIMessageForExistingIncident}</a>
                                        </td>
                                    </tr>
                                  </table>
                                
                              </td>
                          </tr>
                       </table>
                       <iframe name='SIIframeID' id='SIIframeID'  width='100%' height='100%' frameborder='0' style="display:none"/>
                        </div>
    
    
    
<c:TabOutComponent ></c:TabOutComponent>
       
  </apex:form>
  </apex:outputPanel>
    <script>
	    var btnChangeRequestValue = '{!JSENCODE($ObjectType.Change_Request__c.fields.Change_Description__c.label)}';
	    if(btnChangeRequestValue.length > 11 && document.getElementById('changeDescriptionBtn') != 'undefined'){
	    	btnChangeRequestValue = Ext.util.Format.ellipsis(btnChangeRequestValue,14);  
	    }
	    document.getElementById('changeDescriptionBtn').value = btnChangeRequestValue;	 
	    
	    var btnReason_for_Change__cValue = '{!JSENCODE($ObjectType.Change_Request__c.fields.Reason_for_Change__c.label)}';
	    if(btnReason_for_Change__cValue.length > 17 && document.getElementById('reasonForChangeBtn') != 'undefined'){
	    	btnReason_for_Change__cValue = Ext.util.Format.ellipsis(btnReason_for_Change__cValue,20);
	    }
	    document.getElementById('reasonForChangeBtn').value = btnReason_for_Change__cValue;
	    
	    var btnrolloutPlanValue = '{!JSENCODE($ObjectType.Change_Request__c.fields.Roll_Out_Plan__c.label)}';
	    if(btnrolloutPlanValue.length > 12 && document.getElementById('rolloutPlanBtn') != 'undefined'){
	    	btnrolloutPlanValue = Ext.util.Format.ellipsis(btnrolloutPlanValue,15);   
	    }
	    document.getElementById('rolloutPlanBtn').value = btnrolloutPlanValue;
	    
	   	var btnbackoutPlanValue = '{!JSENCODE($ObjectType.Change_Request__c.fields.Back_Out_Plan__c.label)}';
	    if(btnbackoutPlanValue.length > 13 && document.getElementById('backoutPlanBtn') != 'undefined'){
	    	btnbackoutPlanValue = Ext.util.Format.ellipsis(btnbackoutPlanValue,16);  	    	 
	    }
	    document.getElementById('backoutPlanBtn').value = btnbackoutPlanValue;   

    	var stime = '{!serverstarttime}';
    	var etime = '{!currenttime}';
    	var servertime = etime - stime;
    	var networkstart = etime;
    	data +=servertime;
    	data += '<br>';
    </script>   
    <apex:outputPanel id="urlStringPanelId">
    <script>
    urlStringVar ="{!urlQueryString}" 
    </script>
    </apex:outputPanel>       
</apex:page>